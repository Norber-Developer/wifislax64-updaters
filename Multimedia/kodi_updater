#!/bin/sh

# Script by www.seguridadwireless.net

SCRIPT_VERSION=20161003
CATEGORIA="Reproductores multimedia"

############################################################
## Funciones comunes. Su nombre empieza por f_ ##
############################################################
f_variables(){
	. /opt/wifislax-updaters/Funciones/funciones_updater
}

############################################################
## Funciones propias del script. Su nombre empieza por F_ ##
############################################################
# Definicion de variables
F_variables() {
	PRGNAM=kodi
	echo -ne "\033]2;${PRGNAM}_updater\007"
	WEB=https://github.com/xbmc/xbmc
	VERSION=$(curl -s $WEB/releases/latest|cut -d "/" -f8|cut -d '"' -f1|cut -d- -f-1)
	RAMA=$(curl -s $WEB/releases/latest|cut -d "/" -f8|cut -d '"' -f1|cut -d- -f2)
	SRCNAM=xbmc-$VERSION-$RAMA
	EXTENSION=tar.gz
	SOURCES=$VERSION-$RAMA.$EXTENSION
	DOWNLOAD=$WEB/archive/$SOURCES
}

# Comprobar dependencias
F_dependencias(){
DEPENDENCIAS="dcadec libass libmpeg2 tinyxml jdk yajl libbluray libmicrohttpd crossguid libnfs" 
f_dependencias
}

# Descomprimimos el fichero descargado y compilamos
F_compilar(){
echo 
echo "$VERDE"Configurando ..."$CIERRE"
sleep 1

echo "
ZGlmZiAtTmF1ciB4Ym1jLUdvdGhhbV9hbHBoYTkub3JpZy94Ym1jL2NvcmVzL2R2ZHBsYXllci9E
VkRJbnB1dFN0cmVhbXMvRFZESW5wdXRTdHJlYW1SVE1QLmNwcCB4Ym1jLUdvdGhhbV9hbHBoYTkv
eGJtYy9jb3Jlcy9kdmRwbGF5ZXIvRFZESW5wdXRTdHJlYW1zL0RWRElucHV0U3RyZWFtUlRNUC5j
cHAKLS0tIHhibWMtR290aGFtX2FscGhhOS5vcmlnL3hibWMvY29yZXMvZHZkcGxheWVyL0RWRElu
cHV0U3RyZWFtcy9EVkRJbnB1dFN0cmVhbVJUTVAuY3BwCTIwMTMtMTAtMzEgMTY6NDg6NDUuMDAw
MDAwMDAwICswMDAwCisrKyB4Ym1jLUdvdGhhbV9hbHBoYTkveGJtYy9jb3Jlcy9kdmRwbGF5ZXIv
RFZESW5wdXRTdHJlYW1zL0RWRElucHV0U3RyZWFtUlRNUC5jcHAJMjAxMy0xMS0yOCAwNTo0Nzoz
Ni40MTg3NjM5MTcgKzAwMDAKQEAgLTIxLDkgKzIxLDcgQEAKICNpZiAoZGVmaW5lZCBIQVZFX0NP
TkZJR19IKSAmJiAoIWRlZmluZWQgVEFSR0VUX1dJTkRPV1MpCiAgICNpbmNsdWRlICJjb25maWcu
aCIKICNlbmRpZgotI2lmZGVmIFRBUkdFVF9XSU5ET1dTCiAjaW5jbHVkZSAic3lzdGVtLmgiIC8v
IGp1c3QgZm9yIEhBU19MSUJSVE1QCi0jZW5kaWYKIAogI2lmZGVmIEhBU19MSUJSVE1QCiAjaW5j
bHVkZSAic2V0dGluZ3MvQWR2YW5jZWRTZXR0aW5ncy5oIgo=
" | base64 -d > $TMP/xbmc-Gotham-rtmpdump-build.patch
patch -p1 -i $TMP/xbmc-Gotham-rtmpdump-build.patch || exit 1

echo "
ZGlmZiAtTmF1ciB4Ym1jLTE0LjAtSGVsaXgub3JpZy94Ym1jL2ZpbGVzeXN0ZW0vU01CRGlyZWN0
b3J5LmNwcCB4Ym1jLTE0LjAtSGVsaXgveGJtYy9maWxlc3lzdGVtL1NNQkRpcmVjdG9yeS5jcHAK
LS0tIHhibWMtMTQuMC1IZWxpeC5vcmlnL3hibWMvZmlsZXN5c3RlbS9TTUJEaXJlY3RvcnkuY3Bw
CTIwMTQtMTItMjIgMjM6MTE6MzUuMDAwMDAwMDAwICswMDAwCisrKyB4Ym1jLTE0LjAtSGVsaXgv
eGJtYy9maWxlc3lzdGVtL1NNQkRpcmVjdG9yeS5jcHAJMjAxNC0xMi0yNCAwMzozMjowOS4yMjc2
NDMyNjYgKzAwMDAKQEAgLTQyLDcgKzQyLDcgQEAKICNpbmNsdWRlICJ0aHJlYWRzL1NpbmdsZUxv
Y2suaCIKICNpbmNsdWRlICJQYXNzd29yZE1hbmFnZXIuaCIKIAotI2luY2x1ZGUgPGxpYnNtYmNs
aWVudC5oPgorI2luY2x1ZGUgPHNhbWJhLTQuMC9saWJzbWJjbGllbnQuaD4KIAogI2lmIGRlZmlu
ZWQoVEFSR0VUX0RBUldJTikKICNkZWZpbmUgWEJNQ19TTUJfTU9VTlRfUEFUSCAiTGlicmFyeS9B
cHBsaWNhdGlvbiBTdXBwb3J0L0tvZGkvTW91bnRzLyIKZGlmZiAtTmF1ciB4Ym1jLTE0LjAtSGVs
aXgub3JpZy94Ym1jL2ZpbGVzeXN0ZW0vU01CRmlsZS5jcHAgeGJtYy0xNC4wLUhlbGl4L3hibWMv
ZmlsZXN5c3RlbS9TTUJGaWxlLmNwcAotLS0geGJtYy0xNC4wLUhlbGl4Lm9yaWcveGJtYy9maWxl
c3lzdGVtL1NNQkZpbGUuY3BwCTIwMTQtMTItMjIgMjM6MTE6MzUuMDAwMDAwMDAwICswMDAwCisr
KyB4Ym1jLTE0LjAtSGVsaXgveGJtYy9maWxlc3lzdGVtL1NNQkZpbGUuY3BwCTIwMTQtMTItMjQg
MDM6MzI6NTIuNjk3OTEzNzA1ICswMDAwCkBAIC0yNiw3ICsyNiw3IEBACiAjaW5jbHVkZSAiU01C
RmlsZS5oIgogI2luY2x1ZGUgIlBhc3N3b3JkTWFuYWdlci5oIgogI2luY2x1ZGUgIlNNQkRpcmVj
dG9yeS5oIgotI2luY2x1ZGUgPGxpYnNtYmNsaWVudC5oPgorI2luY2x1ZGUgPHNhbWJhLTQuMC9s
aWJzbWJjbGllbnQuaD4KICNpbmNsdWRlICJzZXR0aW5ncy9BZHZhbmNlZFNldHRpbmdzLmgiCiAj
aW5jbHVkZSAic2V0dGluZ3MvU2V0dGluZ3MuaCIKICNpbmNsdWRlICJ0aHJlYWRzL1NpbmdsZUxv
Y2suaCIK
" | base64 -d > $TMP/xbmc-Helix-samba-4.0.patch
patch -p1 -i $TMP/xbmc-Helix-samba-4.0.patch || exit 1

echo "
RnJvbSA3YmMwODc3ZGM5NzE1ZTg5MTE1OTM5MmFiZjY2OWY5NzA3MjJkZWNlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBLZW4gRHJleWVyIDxrdGRyZXllckBrdGRyZXllci5jb20+CkRh
dGU6IE1vbiwgNiBNYXkgMjAxMyAxNzowNzo0MCAtMDYwMApTdWJqZWN0OiBbUEFUQ0ggMS8zXSBG
ZWRvcmE6IHVzZSBleHRlcm5hbCBkdmRyZWFkCgpPcmlnaW5hbCBwYXRjaCBieSBBbGV4IExhbmNh
c3RlciA8YWxleGxhbltBVF1mZWRvcmFwcm9qZWN0IG9yZz4KKGNoZXJyeSBwaWNrZWQgZnJvbSBj
b21taXQgOWY5ODQ1YWY4NDJhMzc2ZDViZGY3MDc0Mjc4NWU3NzI3Njk1ZmQwMykKLS0tCiBib290
c3RyYXAubWsgICAgICAgICAgIHwgIDUgLS0tLS0KIGNvbmZpZ3VyZS5pbiAgICAgICAgICAgfCAx
OSAtLS0tLS0tLS0tLS0tLS0tLS0tCiBsaWIvbGliZHZkL01ha2VmaWxlLmluIHwgMjAgKysrKysr
Ky0tLS0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgNyBpbnNlcnRpb25zKCspLCAzNyBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9ib290c3RyYXAubWsgYi9ib290c3RyYXAubWsKaW5kZXgg
OGJjNDc5NS4uMWZjMzFhNCAxMDA2NDQKLS0tIGEvYm9vdHN0cmFwLm1rCisrKyBiL2Jvb3RzdHJh
cC5tawpAQCAtOCw3ICs4LDYgQEAgaWZuZXEgKCQod2lsZGNhcmQgbGliL2xpYmR2ZC9saWJkdmRj
c3MvY29uZmlndXJlLmFjKSwpCiBCT09UU1RSQVBfU1VCRElSUyArPSBsaWIvbGliZHZkL2xpYmR2
ZGNzcy9jb25maWd1cmUuYWMKIERWRF9DU1M9bGliL2xpYmR2ZC9saWJkdmRjc3MvY29uZmlndXJl
CiBlbmRpZgotQk9PVFNUUkFQX1NVQkRJUlMgKz0gbGliL2xpYmR2ZC9saWJkdmRyZWFkL2NvbmZp
Z3VyZS5hYwogQk9PVFNUUkFQX1NVQkRJUlMgKz0gbGliL2xpYmR2ZC9saWJkdmRuYXYvY29uZmln
dXJlLmFjCiAKIGlmbmVxICgkKHdpbGRjYXJkIHB2ci1hZGRvbnMvTWFrZWZpbGUuYW0pLCkKQEAg
LTE4LDEwICsxNyw2IEBAIGVuZGlmCiBCT09UU1RSQVBfVEFSR0VUUz0kKGJhc2VuYW1lICQoQk9P
VFNUUkFQX1NVQkRJUlMpKQogYWxsOiAkKEJPT1RTVFJBUF9UQVJHRVRTKQogCi0jcHJlc2VydmUg
b3JkZXIgZm9yIGxpYmR2ZC4gZHZkY3NzIChpZiBwcmVzZW50KSAtPiBkdmRyZWFkIC0+IGR2ZG5h
di4KLWxpYi9saWJkdmQvbGliZHZkcmVhZC9jb25maWd1cmU6ICQoRFZEX0NTUykKLWxpYi9saWJk
dmQvbGliZHZkbmF2L2NvbmZpZ3VyZTogbGliL2xpYmR2ZC9saWJkdmRyZWFkL2NvbmZpZ3VyZQot
CiAlOiAlLmFjCiAJYXV0b3JlY29uZiAtdmlmICQoQEQpCiAJLUBybSAtcmYgJChARCkvYXV0b200
dGUuY2FjaGUKZGlmZiAtLWdpdCBhL2NvbmZpZ3VyZS5pbiBiL2NvbmZpZ3VyZS5pbgppbmRleCBi
ZWI4YWFjLi4zNDMyOTJlIDEwMDY0NAotLS0gYS9jb25maWd1cmUuYWMKKysrIGIvY29uZmlndXJl
LmFjCkBAIC0yODYwLDI3ICsyODYwLDkgQEAKICAgICAtLXdpdGgtcGljCiBdLCBbJFNLSVBfQ09O
RklHX0RWRENTU10pCiAKLVhCX0NPTkZJR19NT0RVTEUoW2xpYi9saWJkdmQvbGliZHZkcmVhZF0s
IFsKLSAgLi9jb25maWd1cmUyIFwKLSAgICAtLWV4dHJhLWNmbGFncz0iJENGTEFHUyAkRFZEUkVB
RF9DRkxBR1MgLUlgcHdkYC8uLi9saWJkdmRjc3Mvc3JjICREUk9JRF9EVkRMSUJfU0VFSzY0IiBc
Ci0gICAgLS1wcmVmaXg9IiR7cHJlZml4fSIgLS1pbmNsdWRlZGlyPSIke2luY2x1ZGVkaXJ9IiAt
LWxpYmRpcj0iJHtsaWJkaXJ9IiAtLWRhdGFkaXI9IiR7ZGF0YWRpcn0iIFwKLSAgICAtLWhvc3Q9
JGhvc3RfYWxpYXMgXAotICAgIC0tYnVpbGQ9JGJ1aWxkX2FsaWFzIFwKLSAgICAtLXRhcmdldD0k
dGFyZ2V0X2FsaWFzIFwgICAgICAKLSAgICAtLWVuYWJsZS1zdGF0aWMgXAotICAgIC0tZGlzYWJs
ZS1zaGFyZWQgXAotICAgIC0tZGlzYWJsZS1zdHJpcCBcCi0gICAgLS1kaXNhYmxlLW9wdHMgXAot
ICAgIC0tY2M9IiRDQyIgJiYKLSAgbWtkaXIgLXAgYHB3ZGAvLi4vaW5jbHVkZXMvZHZkcmVhZAot
ICBjcCBgcHdkYC8uLi9saWJkdmRyZWFkL3NyYy8qLmggYHB3ZGAvLi4vaW5jbHVkZXMvZHZkcmVh
ZAotICBjcCBgcHdkYC8uLi9saWJkdmRyZWFkL3NyYy9kdmRyZWFkLyouaCBgcHdkYC8uLi9pbmNs
dWRlcy9kdmRyZWFkCi1dLCBbMF0pCi0KIFhCX0NPTkZJR19NT0RVTEUoW2xpYi9saWJkdmQvbGli
ZHZkbmF2XSwgWwogICAuL2NvbmZpZ3VyZTIgXAogICAgIC0tZXh0cmEtY2ZsYWdzPSIkQ0ZMQUdT
ICREVkRSRUFEX0NGTEFHUyAtSWBwd2RgLy4uL2luY2x1ZGVzICREUk9JRF9EVkRMSUJfU0VFSzY0
IiBcCi0gICAgLS1leHRyYS1sZGZsYWdzPSItTGBwd2RgLy4uL2xpYmR2ZHJlYWQvb2JqIiBcCiAg
ICAgLS13aXRoLWR2ZHJlYWQtY29uZmlnPSJgcHdkYC8uLi9kdmRyZWFkLWNvbmZpZyIgXAogICAg
IC0tcHJlZml4PSIke3ByZWZpeH0iIC0taW5jbHVkZWRpcj0iJHtpbmNsdWRlZGlyfSIgLS1saWJk
aXI9IiR7bGliZGlyfSIgLS1kYXRhZGlyPSIke2RhdGFkaXJ9IiBcCiAgICAgLS1ob3N0PSRob3N0
X2FsaWFzIFwKZGlmZiAtLWdpdCBhL2xpYi9saWJkdmQvTWFrZWZpbGUuaW4gYi9saWIvbGliZHZk
L01ha2VmaWxlLmluCmluZGV4IDY5ZDIyODYuLjFmNWVlYmIgMTAwNjQ0Ci0tLSBhL2xpYi9saWJk
dmQvTWFrZWZpbGUuaW4KKysrIGIvbGliL2xpYmR2ZC9NYWtlZmlsZS5pbgpAQCAtNSw4ICs1LDcg
QEAgQ1hYPUBDWFhACiAKIFNZU0RJUj1AYWJzX3RvcF9zcmNkaXJAL3N5c3RlbS9wbGF5ZXJzL2R2
ZHBsYXllcgogU09TPSBsaWJkdmRuYXYtJChBUkNIKS5zbwotRElSUz0JbGliZHZkcmVhZCBcCi0J
bGliZHZkbmF2CitESVJTPQlsaWJkdmRuYXYKIAogV1JBUFBFUj1AYWJzX3RvcF9zcmNkaXJAL3hi
bWMvY29yZXMvRGxsTG9hZGVyL2V4cG9ydHMvd3JhcHBlci5vCiBXUkFQUEVSX01BQ0hfQUxJQVM9
QGFic190b3Bfc3JjZGlyQC94Ym1jL2NvcmVzL0RsbExvYWRlci9leHBvcnRzL3dyYXBwZXJfbWFj
aF9hbGlhcwpAQCAtMTQsNyArMTMsNyBAQCBXUkFQUEVSX01BQ0hfQUxJQVM9QGFic190b3Bfc3Jj
ZGlyQC94Ym1jL2NvcmVzL0RsbExvYWRlci9leHBvcnRzL3dyYXBwZXJfbWFjaF9hbAogaWZlcSAo
JChmaW5kc3RyaW5nIG9zeCwkKEFSQ0gpKSxvc3gpCiBMREZMQUdTICs9LWJ1bmRsZSAtdW5kZWZp
bmVkIGR5bmFtaWNfbG9va3VwIC1yZWFkX29ubHlfcmVsb2NzIHN1cHByZXNzCiBlbHNlCi1MREZM
QUdTICs9IC1zaGFyZWQgLWZQSUMgLXJkeW5hbWljCitMREZMQUdTICs9IC1zaGFyZWQgLWZQSUMg
LXJkeW5hbWljIC1sZHZkcmVhZAogZW5kaWYKIAogaWZlcSAoJChBUkNIKSwgcG93ZXJwYy1vc3gp
CkBAIC0zNSw4ICszNCw3IEBAIFNMSUI9JChhZGRwcmVmaXggJChTWVNESVIpLywgJChTT1MpKQog
CiBESVNUQ0xFQU5fRklMRVM9aW5jbHVkZXMvZHZkcmVhZC8qLmggXAogCQlpbmNsdWRlcy9kdmRj
c3MvKi5oIFwKLQkJbGliZHZkbmF2L2NvbmZpZy5oIFwKLQkJbGliZHZkcmVhZC9jb25maWcuaAor
CQlsaWJkdmRuYXYvY29uZmlnLmgKIAogLlBIT05ZOiAkKERJUlMpIGNvbXBpbGUKIApAQCAtNDgs
OSArNDYsOSBAQCAkKFNZU0RJUikvbGliZHZkY3NzLSQoQVJDSCkuc286ICAkKCQoV1JBUFBFUikp
IGxpYmR2ZGNzcy9zcmMvLmxpYnMvbGliZHZkY3NzLmEKIAkkKENDKSAkKExERkxBR1MpIC1XbCwt
YWxpYXNfbGlzdCwkKFdSQVBQRVJfTUFDSF9BTElBUykgLW8gJEAgXAogCQkkKFdSQVBQRVIpIGxp
YmR2ZGNzcy9zcmMvKi5vICQoQlVORExFMV9PKQogCi0kKFNZU0RJUikvbGliZHZkbmF2LSQoQVJD
SCkuc286ICQoJChXUkFQUEVSKSkgJChEVkRDU1NfQSkgbGliZHZkcmVhZC9vYmovbGliZHZkcmVh
ZC5hIGxpYmR2ZG5hdi9vYmovbGliZHZkbmF2LmEKKyQoU1lTRElSKS9saWJkdmRuYXYtJChBUkNI
KS5zbzogJCgkKFdSQVBQRVIpKSAkKERWRENTU19BKSBsaWJkdmRuYXYvb2JqL2xpYmR2ZG5hdi5h
CiAJJChDQykgJChMREZMQUdTKSAtV2wsLWFsaWFzX2xpc3QsJChXUkFQUEVSX01BQ0hfQUxJQVMp
IC1vICRAIFwKLQkJJChXUkFQUEVSKSAkKERWRENTU19PKSBsaWJkdmRyZWFkL29iai8qLm8gbGli
ZHZkbmF2L29iai8qLm8gJChCVU5ETEUxX08pCisJCSQoV1JBUFBFUikgJChEVkRDU1NfTykgbGli
ZHZkbmF2L29iai8qLm8gJChCVU5ETEUxX08pCiAKIGVsc2UKIApAQCAtNTksOCArNTcsOCBAQCAk
KFNZU0RJUikvbGliZHZkY3NzLSQoQVJDSCkuc286ICQoV1JBUFBFUikgbGliZHZkY3NzL3NyYy8u
bGlicy9saWJkdmRjc3MuYQogCQlsaWJkdmRjc3Mvc3JjLyoubyAtV2wsLS11bnJlc29sdmVkLXN5
bWJvbHM9aWdub3JlLWFsbCAtbG0gXAogCQlgY2F0ICQoV1JBUFBFUjoubz0uZGVmKWAgJChXUkFQ
UEVSKQogCi0kKFNZU0RJUikvbGliZHZkbmF2LSQoQVJDSCkuc286ICQoV1JBUFBFUikgJChEVkRD
U1NfQSkgbGliZHZkcmVhZC9vYmovbGliZHZkcmVhZC5hIGxpYmR2ZG5hdi9vYmovbGliZHZkbmF2
LmEKLQkkKENDKSAtbyAkQCAkKExERkxBR1MpIC1XbCwtLXNvbmFtZSwkQCAkKERWRENTU19PKSBs
aWJkdmRyZWFkL29iai8qLm8gbGliZHZkbmF2L29iai8qLm8gLWxtIFwKKyQoU1lTRElSKS9saWJk
dmRuYXYtJChBUkNIKS5zbzogJChXUkFQUEVSKSAkKERWRENTU19BKSBsaWJkdmRuYXYvb2JqL2xp
YmR2ZG5hdi5hCisJJChDQykgLW8gJEAgJChMREZMQUdTKSAtV2wsLS1zb25hbWUsJEAgJChEVkRD
U1NfTykgbGliZHZkbmF2L29iai8qLm8gLWxtIFwKIAkJLVdsLC0tdW5yZXNvbHZlZC1zeW1ib2xz
PWlnbm9yZS1hbGwgXAogCQlgY2F0ICQoV1JBUFBFUjoubz0uZGVmKWAgJChXUkFQUEVSKQogCkBA
IC03MCwxMCArNjgsNiBAQCBsaWJkdmRjc3Mvc3JjLy5saWJzL2xpYmR2ZGNzcy5hOiBsaWJkdmRj
c3M7CiBsaWJkdmRjc3M6IGNvbXBpbGUKIAkkKE1BS0UpIC1DICRACiAKLWxpYmR2ZHJlYWQvb2Jq
L2xpYmR2ZHJlYWQuYTogbGliZHZkcmVhZDsKLWxpYmR2ZHJlYWQ6IGNvbXBpbGUKLQkkKE1BS0Up
IC1DICRACi0KIGxpYmR2ZG5hdi9vYmovbGliZHZkbmF2LmE6IGxpYmR2ZG5hdjsKIGxpYmR2ZG5h
djogY29tcGlsZQogCSQoTUFLRSkgLUMgJEAKLS0gCjEuOC41LjMKCg==
" | base64 -d > $TMP/xbmc-15.0-dvdread.patch
patch -p1 -i $TMP/xbmc-15.0-dvdread.patch || exit 1

echo "
LS0tIHRvb2xzL2RlcGVuZHMvbmF0aXZlL1RleHR1cmVQYWNrZXIvTWFrZWZpbGUub2xkCTIwMTUt
MDMtMTcgMjI6Mjk6MTguODgwMDI5NTA5ICswMTAwCisrKyB0b29scy9kZXBlbmRzL25hdGl2ZS9U
ZXh0dXJlUGFja2VyL01ha2VmaWxlCTIwMTUtMDMtMTcgMjI6Mjk6NDEuNDU5NjcxNjc5ICswMTAw
CkBAIC05LDE0ICs5LDEwIEBACiAKIGlmZXEgKCQoTkFUSVZFUExBVEZPUk0pLCkKICAgUExBVEZP
Uk0gPSBuYXRpdmUKLSAgRVhUUkFfQ09ORklHVVJFID0gLS1lbmFibGUtc3RhdGljCiBlbHNlCiAg
IFBMQVRGT1JNID0gJChOQVRJVkVQTEFURk9STSkKIGVuZGlmCiAKLWlmZXEgKCQoTkFUSVZFX09T
KSwgbGludXgpCi0gIEVYVFJBX0NPTkZJR1VSRSA9IC0tZW5hYmxlLXN0YXRpYwotZW5kaWYKIGlm
ZXEgKCQoTkFUSVZFX09TKSwgYW5kcm9pZCkKICAgRVhUUkFfQ09ORklHVVJFID0gLS1lbmFibGUt
c3RhdGljCiBlbmRpZgo=
" | base64 -d > $TMP/kodi-texturepacker.patch
patch -p0 -i $TMP/kodi-texturepacker.patch || exit 1

export PATH="$PATH:$PWD/tools/depends/native/JsonSchemaBuilder/bin"

./bootstrap

CFLAGS="$SLKCFLAGS $AFPFS_NGFLAGS" \
CXXFLAGS="$SLKCFLAGS $AFPFS_NGFLAGS" \
LDFLAGS="-L/usr/lib${LIBDIRSUFFIX}" \
./configure \
  --prefix=/usr \
  --libdir=/usr/lib${LIBDIRSUFFIX} \
  --docdir=/usr/doc/$PRGNAM-$VERSION \
  --enable-static=no \
  --disable-debug \
  --enable-gl \
  --enable-mid \
  --enable-goom \
  --enable-alsa \
  --disable-asap-codec \
  --enable-pulse \
  --enable-webserver \
  --enable-shared-libraries \
  --build=$ARCH-slackware-linux
    
echo 
echo "$VERDE"Compilando ..."$CIERRE"
sleep 1
make VERBOSE=1 || exit 1

make install DESTDIR=$PKG || exit 1
python -m compileall $PKG/usr/share/$PRGNAM/addons/service.xbmc.versioncheck
install -m 0755 tools/TexturePacker/TexturePacker $PKG/usr/lib${LIBDIRSUFFIX}/$PRGNAM
find $PKG \( -name "Makefile*" -o -name "*cmake*" -o -name "*\.in" \) -exec rm -f '{}' \;
}

###################################
## BLOQUE PRINCIPAL DE EJECUCION ##
###################################
# Si se cierra el script inesperadamente, ejecutar la funcion de limpieza
trap f_exitmode SIGHUP SIGINT

#Inicializamos las variables globales
f_variables
#Comprobamos conexion a Internet
f_comprobarConexion
#Inicializamos las variables del script
F_variables
#Creamos directorio de trabajo
f_directorioTemporal
#Mostramos el mensaje de presentacion
f_presentacion
#Comprobamos updates del script
f_comprobarUpdates
#Asignamos o detectamos arquitectura
f_arquitectura
#Comprobamos version instalada del paquete
f_versionInstalada
#Compronar dependencias
F_dependencias
#Si no existe el fichero se descargara
f_download
#Preparamos entorno
f_preparar
#Descomprimir fichero descargado y compilamos
F_compilar
#Hacemos strip sobre el paquete
f_strip
#Creamos xzm , instalamos y salimos
f_tareasFinales