#!/bin/sh

# Script by www.seguridadwireless.net

SCRIPT_VERSION=20161112

############################################################
## Funciones comunes. Su nombre empieza por f_ ##
############################################################
f_variables(){
	. /opt/wifislax-updaters/Funciones/funciones_updater
}

############################################################
## Funciones propias del script. Su nombre empieza por F_ ##
############################################################
# Definicion de variables
F_variables() {
	PRGNAM=libquicktime
	echo -ne "\033]2;${PRGNAM}_updater\007"
	WEB=http://downloads.sourceforge.net/$PRGNAM/
	VERSION=1.2.4
	EXTENSION=tar.gz
	SOURCES=$PRGNAM-$VERSION.$EXTENSION
	DOWNLOAD=$WEB/$SOURCES
}

# Comprobar dependencias
F_dependencias(){
DEPENDENCIAS="faac faad2 ffmpeg lame libdv schroedinger x264"
f_dependencias
}

# Descomprimimos el fichero descargado y compilamos
F_compilar(){
echo 
echo "$VERDE"Configurando ..."$CIERRE"
sleep 1

echo "QmluYXJ5IGZpbGVzIGEvcGx1Z2lucy9mZm1wZWcvLmxxdF9mZm1wZWcuYy5zd3AgYW5kIGIvcGx1
Z2lucy9mZm1wZWcvLmxxdF9mZm1wZWcuYy5zd3AgZGlmZmVyCmRpZmYgLXJ1cE4gYS9wbHVnaW5z
L2ZmbXBlZy9mZm1wZWcuaCBiL3BsdWdpbnMvZmZtcGVnL2ZmbXBlZy5oCi0tLSBhL3BsdWdpbnMv
ZmZtcGVnL2ZmbXBlZy5oCTIwMTItMDItMTUgMjA6NDg6MzAuMDAwMDAwMDAwICswMTAwCisrKyBi
L3BsdWdpbnMvZmZtcGVnL2ZmbXBlZy5oCTIwMTMtMDctMTUgMTU6MDU6MTkuMzA3NTM0NTkzICsw
MjAwCkBAIC00NSwzICs0NSw3IEBAIHZvaWQgbHF0X2ZmbXBlZ19zZXRfcGFyYW1ldGVyKEFWQ29k
ZWNDb24KIAogCiAjZW5kaWYKKyNkZWZpbmUgQVZDT0RFQ19NQVhfQVVESU9fRlJBTUVfU0laRSAx
OTIwMDAKKyNkZWZpbmUgQ09ERUNfRkxBRzJfU1RSSUNUX0dPUCAweDAwMDAwMDAyCisjZGVmaW5l
IENPREVDX0ZMQUdfUVBfUkQgMHgwODAwMDAwMAorI2RlZmluZSBDT0RFQ19GTEFHX0NCUF9SRCAw
eDA0MDAwMDAwCmRpZmYgLXJ1cE4gYS9wbHVnaW5zL2ZmbXBlZy9scXRfZmZtcGVnLmMgYi9wbHVn
aW5zL2ZmbXBlZy9scXRfZmZtcGVnLmMKLS0tIGEvcGx1Z2lucy9mZm1wZWcvbHF0X2ZmbXBlZy5j
CTIwMTItMDItMTUgMjA6NDg6MzAuMDAwMDAwMDAwICswMTAwCisrKyBiL3BsdWdpbnMvZmZtcGVn
L2xxdF9mZm1wZWcuYwkyMDEzLTA3LTE1IDE1OjE5OjA5LjczMDgzMTY1NSArMDIwMApAQCAtODks
MTkgKzg5LDggQEAgaW50IGZmbXBlZ19udW1fdmlkZW9fY29kZWNzID0gLTE7CiAgICAgUEFSQU1f
UVNDQUxFLCBcCiAgICAgUEFSQU1fUUNPTVBSRVNTLCBcCiAgICAgUEFSQU1fUUJMVVIsIFwKLSAg
ICBQQVJBTV9RVUFOVElaRVJfTk9JU0VfU0hBUElORywgXAogICAgIFBBUkFNX1RSRUxMSVMKIAot
I2RlZmluZSBFTkNPREVfUEFSQU1fVklERU9fUVVBTlRJWkVSX0lQIFwKLSAgRU5DT0RFX1BBUkFN
X1ZJREVPX1FVQU5USVpFUl9JLCBcCi0gIFBBUkFNX0lfUVVBTlRfRkFDVE9SLCBcCi0gIFBBUkFN
X0lfUVVBTlRfT0ZGU0VUCi0KLSNkZWZpbmUgRU5DT0RFX1BBUkFNX1ZJREVPX1FVQU5USVpFUl9J
UEIgXAotICBFTkNPREVfUEFSQU1fVklERU9fUVVBTlRJWkVSX0lQLCBcCi0gIFBBUkFNX0JfUVVB
TlRfRkFDVE9SLCBcCi0gIFBBUkFNX0JfUVVBTlRfT0ZGU0VUCi0KICNkZWZpbmUgRU5DT0RFX1BB
UkFNX1ZJREVPX0ZSQU1FVFlQRVNfSVAgXAogICB7IFwKICAgICAubmFtZSA9ICAgICAgImZyYW1l
X3R5cGVzIiwgXApAQCAtMjA3LDcgKzE5Niw2IEBAIHN0YXRpYyBscXRfcGFyYW1ldGVyX2luZm9f
c3RhdGljX3QgZW5jb2QKICAgRU5DT0RFX1BBUkFNX1ZJREVPX0ZSQU1FVFlQRVNfSVBCLAogICBQ
QVJBTV9GTEFHX0FDX1BSRURfTVBFRzQsCiAgIEVOQ09ERV9QQVJBTV9WSURFT19SQVRFQ09OVFJP
TCwKLSAgRU5DT0RFX1BBUkFNX1ZJREVPX1FVQU5USVpFUl9JUEIsCiAgIFBBUkFNX0ZMQUdfQ0JQ
X1JELAogICBFTkNPREVfUEFSQU1fVklERU9fTUUsCiAgIFBBUkFNX0ZMQUdfR01DLApAQCAtMjI1
LDcgKzIxMyw2IEBAIHN0YXRpYyBscXRfcGFyYW1ldGVyX2luZm9fc3RhdGljX3QgZW5jb2QKIHN0
YXRpYyBscXRfcGFyYW1ldGVyX2luZm9fc3RhdGljX3QgZW5jb2RlX3BhcmFtZXRlcnNfZHg1MFtd
ID0gewogICBFTkNPREVfUEFSQU1fVklERU9fRlJBTUVUWVBFU19JUCwKICAgRU5DT0RFX1BBUkFN
X1ZJREVPX1JBVEVDT05UUk9MLAotICBFTkNPREVfUEFSQU1fVklERU9fUVVBTlRJWkVSX0lQLAog
ICBFTkNPREVfUEFSQU1fVklERU9fTUUsCiAgIEVOQ09ERV9QQVJBTV9WSURFT19NRV9QUkUsCiAg
IEVOQ09ERV9QQVJBTV9WSURFT19NQVNLSU5HLApAQCAtMjM3LDcgKzIyNCw2IEBAIHN0YXRpYyBs
cXRfcGFyYW1ldGVyX2luZm9fc3RhdGljX3QgZW5jb2QKIHN0YXRpYyBscXRfcGFyYW1ldGVyX2lu
Zm9fc3RhdGljX3QgZW5jb2RlX3BhcmFtZXRlcnNfaDI2M1tdID0gewogICBFTkNPREVfUEFSQU1f
VklERU9fRlJBTUVUWVBFU19JUCwKICAgRU5DT0RFX1BBUkFNX1ZJREVPX1JBVEVDT05UUk9MLAot
ICBFTkNPREVfUEFSQU1fVklERU9fUVVBTlRJWkVSX0lQLAogICBFTkNPREVfUEFSQU1fVklERU9f
TUUsCiAgIFBBUkFNX0ZMQUdfNE1WLAogICBFTkNPREVfUEFSQU1fVklERU9fTUVfUFJFLApAQCAt
MjUwLDcgKzIzNiw2IEBAIHN0YXRpYyBscXRfcGFyYW1ldGVyX2luZm9fc3RhdGljX3QgZW5jb2QK
IHN0YXRpYyBscXRfcGFyYW1ldGVyX2luZm9fc3RhdGljX3QgZW5jb2RlX3BhcmFtZXRlcnNfaDI2
M3BbXSA9IHsKICAgRU5DT0RFX1BBUkFNX1ZJREVPX0ZSQU1FVFlQRVNfSVAsCiAgIEVOQ09ERV9Q
QVJBTV9WSURFT19SQVRFQ09OVFJPTCwKLSAgRU5DT0RFX1BBUkFNX1ZJREVPX1FVQU5USVpFUl9J
UCwKICAgRU5DT0RFX1BBUkFNX1ZJREVPX01FLAogICBQQVJBTV9GTEFHXzRNViwKICAgRU5DT0RF
X1BBUkFNX1ZJREVPX01FX1BSRSwKQEAgLTI2NCw3ICsyNDksNiBAQCBzdGF0aWMgbHF0X3BhcmFt
ZXRlcl9pbmZvX3N0YXRpY190IGVuY29kCiBzdGF0aWMgbHF0X3BhcmFtZXRlcl9pbmZvX3N0YXRp
Y190IGVuY29kZV9wYXJhbWV0ZXJzX21zbXBlZzR2M1tdID0gewogICBFTkNPREVfUEFSQU1fVklE
RU9fRlJBTUVUWVBFU19JUCwKICAgRU5DT0RFX1BBUkFNX1ZJREVPX1JBVEVDT05UUk9MLAotICBF
TkNPREVfUEFSQU1fVklERU9fUVVBTlRJWkVSX0lQLAogICBFTkNPREVfUEFSQU1fVklERU9fTUUs
CiAgIEVOQ09ERV9QQVJBTV9WSURFT19NRV9QUkUsCiAgIEVOQ09ERV9QQVJBTV9WSURFT19NQVNL
SU5HLApkaWZmIC1ydXBOIGEvcGx1Z2lucy9mZm1wZWcvcGFyYW1zLmMgYi9wbHVnaW5zL2ZmbXBl
Zy9wYXJhbXMuYwotLS0gYS9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMuYwkyMDEyLTAzLTA3IDE1OjEw
OjQxLjAwMDAwMDAwMCArMDEwMAorKysgYi9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMuYwkyMDEzLTA3
LTE1IDE1OjA5OjM4LjIxNDE4OTk1MyArMDIwMApAQCAtMjAyLDggKzIwMiwxMCBAQCB2b2lkIGxx
dF9mZm1wZWdfc2V0X3BhcmFtZXRlcihBVkNvZGVjQ29uCiAgIFBBUkFNX0lOVCgiZmZfbWF4X2Jf
ZnJhbWVzIixtYXhfYl9mcmFtZXMpOwogICBQQVJBTV9GTE9BVCgiZmZfYl9xdWFudF9mYWN0b3Ii
LGJfcXVhbnRfZmFjdG9yKTsKICAgUEFSQU1fSU5UKCJmZl9iX2ZyYW1lX3N0cmF0ZWd5IixiX2Zy
YW1lX3N0cmF0ZWd5KTsKKyNpZiAoTElCQVZDT0RFQ19WRVJTSU9OX01BSk9SIDwgNTUpCiAgIFBB
UkFNX0lOVCgiZmZfbHVtYV9lbGltX3RocmVzaG9sZCIsbHVtYV9lbGltX3RocmVzaG9sZCk7CiAg
IFBBUkFNX0lOVCgiZmZfY2hyb21hX2VsaW1fdGhyZXNob2xkIixjaHJvbWFfZWxpbV90aHJlc2hv
bGQpOworI2VuZGlmCiAgIFBBUkFNX0lOVCgiZmZfc3RyaWN0X3N0ZF9jb21wbGlhbmNlIixzdHJp
Y3Rfc3RkX2NvbXBsaWFuY2UpOwogICBQQVJBTV9RUDJMQU1CREEoImZmX2JfcXVhbnRfb2Zmc2V0
IixiX3F1YW50X29mZnNldCk7CiAgIFBBUkFNX0lOVCgiZmZfcmNfbWluX3JhdGUiLHJjX21pbl9y
YXRlKTsKQEAgLTI0MSw4ICsyNDMsMTAgQEAgdm9pZCBscXRfZmZtcGVnX3NldF9wYXJhbWV0ZXIo
QVZDb2RlY0NvbgogICBQQVJBTV9RUDJMQU1CREEoImZmX2xtYXgiLCBsbWF4KTsKICAgUEFSQU1f
SU5UKCJmZl9ub2lzZV9yZWR1Y3Rpb24iLG5vaXNlX3JlZHVjdGlvbik7CiAgIFBBUkFNX0lOVF9T
Q0FMRSgiZmZfcmNfaW5pdGlhbF9idWZmZXJfb2NjdXBhbmN5IixyY19pbml0aWFsX2J1ZmZlcl9v
Y2N1cGFuY3ksMTAwMCk7CisjaWYgI2lmIChMSUJBVkNPREVDX1ZFUlNJT05fTUFKT1IgPCA1NSkK
ICAgUEFSQU1fSU5UKCJmZl9pbnRlcl90aHJlc2hvbGQiLGludGVyX3RocmVzaG9sZCk7CiAgIFBB
UkFNX0lOVCgiZmZfcXVhbnRpemVyX25vaXNlX3NoYXBpbmciLHF1YW50aXplcl9ub2lzZV9zaGFw
aW5nKTsKKyNlbmRpZgogICBQQVJBTV9JTlQoImZmX3RocmVhZF9jb3VudCIsdGhyZWFkX2NvdW50
KTsKICAgUEFSQU1fSU5UKCJmZl9tZV90aHJlc2hvbGQiLG1lX3RocmVzaG9sZCk7CiAgIFBBUkFN
X0lOVCgiZmZfbWJfdGhyZXNob2xkIixtYl90aHJlc2hvbGQpOwpkaWZmIC1ydXBOIGEvcGx1Z2lu
cy9mZm1wZWcvcGFyYW1zLmggYi9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMuaAotLS0gYS9wbHVnaW5z
L2ZmbXBlZy9wYXJhbXMuaAkyMDExLTA1LTExIDE3OjEzOjM5LjAwMDAwMDAwMCArMDIwMAorKysg
Yi9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMuaAkyMDEzLTA3LTE1IDE1OjA5OjA0Ljg2MDg1ODA2OSAr
MDIwMApAQCAtMTc3LDYgKzE3Nyw3IEBAIHRoZSByZWZlcmVuY2UuIFVudXNlZCBmb3IgY29uc3Rh
bnQgcXVhbnQKICAgICAudmFsX21heCA9ICAgICB7IC52YWxfaW50ID0gMSB9LCBcCiAgIH0KIAor
I2lmIChMSUJBVkNPREVDX1ZFUlNJT05fTUFKT1IgPCA1NSkKICNkZWZpbmUgUEFSQU1fTFVNQV9F
TElNX1RIUkVTSE9MRCBcCiAgIHsgXAogICAgIC5uYW1lID0gICAgICAgICJmZl9sdW1hX2VsaW1f
dGhyZXNob2xkIiwgXApAQCAtMjAyLDYgKzIwMyw3IEBAIHJlY29tbWVuZGF0aW9uIikgXAogY2hy
b21pbmFtY2UuIE5lZ2F0aXZlIHZhbHVlcyBhbHNvIGNvbnNpZGVyIGRjIFwKIGNvZWZmaWNpZW50
LiA3IGlzIEpWVCByZWNvbW1lbmRhdGlvbiIpIFwKICAgfQorI2VuZGlmCiAKICNkZWZpbmUgUEFS
QU1fU1RSSUNUX1NUQU5EQVJEX0NPTVBMSUFOQ0UgXAogICB7IFwKQEAgLTczOSw2ICs3NDEsNyBA
QCB3aXRoIG1heCBhbmQvb3IgbWluIGJpdHJhdGUsIHRoaXMgbXVzdCBiCiAKIC8qIERvZXMgbm90
aGluZyAqLwogLyoqIEZyYW1lIHR5cGVzICovCisjaWYgKExJQkFWQ09ERUNfVkVSU0lPTl9NQUpP
UiA8IDU1KQogI2RlZmluZSBQQVJBTV9JTlRFUl9USFJFU0hPTEQgXAogICB7IFwKICAgICAubmFt
ZSA9ICAgICAgICAiZmZfaW50ZXJfdGhyZXNob2xkIiwgXApAQCAtNzU5LDYgKzc2Miw3IEBAIHdp
dGggbWF4IGFuZC9vciBtaW4gYml0cmF0ZSwgdGhpcyBtdXN0IGIKICAgICAuaGVscF9zdHJpbmcg
PSBUUlMoIkNob29zZSBxdWFudGl6YXRpb24gc3VjaCB0aGF0IG5vaXNlIHdpbGwgYmUgbWFza2Vk
IGJ5ICIgXAogICAgICAgICAgICAgICAgICAgICAgICAic2ltaWxhci1mcmVxdWVuY3kgY29udGVu
dCBpbiB0aGUgaW1hZ2UiKSAgICAgICAgXAogICB9CisjZW5kaWYKIAogLyoqIE1vdGlvbiBlc3Rp
bWF0aW9uICovCiAjZGVmaW5lIFBBUkFNX01FX1RIUkVTSE9MRCBcCg==
"  | base64 -d > $TMP/ffmpeg2.0.patch

patch -p1 -i $TMP/ffmpeg2.0.patch || exit 1

echo "SW5kZXg6IGxpYnF1aWNrdGltZS0xLjIuNC9wbHVnaW5zL2ZmbXBlZy92aWRlby5jCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KLS0tIGxpYnF1aWNrdGltZS0xLjIuNC5vcmlnL3BsdWdpbnMvZmZtcGVnL3ZpZGVvLmMKKysr
IGxpYnF1aWNrdGltZS0xLjIuNC9wbHVnaW5zL2ZmbXBlZy92aWRlby5jCkBAIC0zNywxMCArMzcs
MTAgQEAKICNlbmRpZgogCiAKLSNpZmRlZiAgUElYX0ZNVF9ZVVY0MjJQMTAKLSNkZWZpbmUgUElY
X0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgUElYX0ZNVF9ZVVY0MjJQMTAKKyNpZmRlZiAgQVZfUElY
X0ZNVF9ZVVY0MjJQMTAKKyNkZWZpbmUgQVZfUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgQVZf
UElYX0ZNVF9ZVVY0MjJQMTAKICNlbHNlCi0jZGVmaW5lIFBJWF9GTVRfWVVWNDIyUDEwX09SX0RV
TU1ZIC0xMjM0CisjZGVmaW5lIEFWX1BJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1ZIC0xMjM0CiAj
ZW5kaWYKIAogI2lmIExJQkFWQ09ERUNfVkVSU0lPTl9JTlQgPj0gKCg1NDw8MTYpfCgxPDw4KXww
KQpAQCAtOTAsOSArOTAsOSBAQCB0eXBlZGVmIHN0cnVjdAogICBpbnQgaW14X2JpdHJhdGU7CiAg
IGludCBpbXhfc3RyaXBfdmJpOwogCi0gIC8qIEluIHNvbWUgY2FzZXMgRkZNcGVnIHdvdWxkIHJl
cG9ydCBzb21ldGhpbmcgbGlrZSBQSVhfRk1UX1lVVjQyMlAsIHdoaWxlCi0gICAgIHdlIHdvdWxk
IGxpa2UgdG8gdHJlYXQgaXQgYXMgUElYX0ZNVF9ZVVZKNDIyUC4gSXQncyBvbmx5IHVzZWQgZm9y
IGRlY29kaW5nICovCi0gIGVudW0gUGl4ZWxGb3JtYXQgcmVpbnRlcnByZXRfcGl4X2ZtdDsKKyAg
LyogSW4gc29tZSBjYXNlcyBGRk1wZWcgd291bGQgcmVwb3J0IHNvbWV0aGluZyBsaWtlIEFWX1BJ
WF9GTVRfWVVWNDIyUCwgd2hpbGUKKyAgICAgd2Ugd291bGQgbGlrZSB0byB0cmVhdCBpdCBhcyBB
Vl9QSVhfRk1UX1lVVko0MjJQLiBJdCdzIG9ubHkgdXNlZCBmb3IgZGVjb2RpbmcgKi8KKyAgZW51
bSBBVlBpeGVsRm9ybWF0IHJlaW50ZXJwcmV0X3BpeF9mbXQ7CiAgIAogICBpbnQgaXNfaW14Owog
ICBpbnQgeV9vZmZzZXQ7CkBAIC0xMzcsNDIgKzEzNyw0MiBAQCB0eXBlZGVmIHN0cnVjdAogCiBz
dGF0aWMgY29uc3Qgc3RydWN0CiAgIHsKLSAgZW51bSBQaXhlbEZvcm1hdCBmZm1wZWdfaWQ7Cisg
IGVudW0gQVZQaXhlbEZvcm1hdCBmZm1wZWdfaWQ7CiAgIGludCAgICAgICAgICAgICAgbHF0X2lk
OwogICBpbnQgICAgICAgICAgICAgIGV4YWN0OwogICB9CiBjb2xvcm1vZGVsc1tdID0KICAgewot
ICAgIHsgUElYX0ZNVF9ZVVY0MjBQLCAgIEJDX1lVVjQyMFAsICAgMSB9LCAvLy88IFBsYW5hciBZ
VVYgNDoyOjAgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDJ4MiBZIHNhbXBsZXMpCisgICAgeyBBVl9Q
SVhfRk1UX1lVVjQyMFAsICAgQkNfWVVWNDIwUCwgICAxIH0sIC8vLzwgUGxhbmFyIFlVViA0OjI6
MCAoMSBDciAmIENiIHNhbXBsZSBwZXIgMngyIFkgc2FtcGxlcykKICNpZiBMSUJBVlVUSUxfVkVS
U0lPTl9JTlQgPCAoNTA8PDE2KQotICAgIHsgUElYX0ZNVF9ZVVY0MjIsICAgIEJDX1lVVjQyMiwg
ICAgMSB9LAorICAgIHsgQVZfUElYX0ZNVF9ZVVY0MjIsICAgIEJDX1lVVjQyMiwgICAgMSB9LAog
I2Vsc2UKLSAgICB7IFBJWF9GTVRfWVVZVjQyMiwgICBCQ19ZVVY0MjIsICAgIDEgfSwKKyAgICB7
IEFWX1BJWF9GTVRfWVVZVjQyMiwgICBCQ19ZVVY0MjIsICAgIDEgfSwKICNlbmRpZgotICAgIHsg
UElYX0ZNVF9SR0IyNCwgICAgIEJDX1JHQjg4OCwgICAgMSB9LCAvLy88IFBhY2tlZCBwaXhlbCwg
MyBieXRlcyBwZXIgcGl4ZWwsIFJHQlJHQi4uLgotICAgIHsgUElYX0ZNVF9CR1IyNCwgICAgIEJD
X0JHUjg4OCwgICAgMSB9LCAvLy88IFBhY2tlZCBwaXhlbCwgMyBieXRlcyBwZXIgcGl4ZWwsIEJH
UkJHUi4uLgotICAgIHsgUElYX0ZNVF9ZVVY0MjJQLCAgIEJDX1lVVjQyMlAsICAgMSB9LCAvLy88
IFBsYW5hciBZVVYgNDoyOjIgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDJ4MSBZIHNhbXBsZXMpCi0g
ICAgeyBQSVhfRk1UX1lVVjQ0NFAsICAgQkNfWVVWNDQ0UCwgICAxIH0sIC8vLzwgUGxhbmFyIFlV
ViA0OjQ6NCAoMSBDciAmIENiIHNhbXBsZSBwZXIgMXgxIFkgc2FtcGxlcykKLSAgICB7IFBJWF9G
TVRfWVVWNDExUCwgICBCQ19ZVVY0MTFQLCAgIDEgfSwgLy8vPCBQbGFuYXIgWVVWIDQ6MToxICgx
IENyICYgQ2Igc2FtcGxlIHBlciA0eDEgWSBzYW1wbGVzKQotICAgIHsgUElYX0ZNVF9ZVVY0MjJQ
MTYsIEJDX1lVVjQyMlAxNiwgMSB9LCAvLy88IFBsYW5hciAxNiBiaXQgWVVWIDQ6MjoyICgxIENy
ICYgQ2Igc2FtcGxlIHBlciAyeDEgWSBzYW1wbGVzKQotI2lmZGVmIFBJWF9GTVRfWVVWNDIyUDEw
Ci0gICAgeyBQSVhfRk1UX1lVVjQyMlAxMCwgQkNfWVVWNDIyUDEwLCAxIH0sIC8vLzwgMTAgYml0
IHNhbXBsZXMgaW4gdWludDE2X3QgY29udGFpbmVycywgcGxhbmFyIDQ6MjoyCi0jZW5kaWYKLSAg
ICB7IFBJWF9GTVRfUkdCNTY1LCAgICBCQ19SR0I1NjUsICAgIDEgfSwgLy8vPCBhbHdheXMgc3Rv
cmVkIGluIGNwdSBlbmRpYW5uZXNzCi0gICAgeyBQSVhfRk1UX1lVVko0MjBQLCAgQkNfWVVWSjQy
MFAsICAxIH0sIC8vLzwgUGxhbmFyIFlVViA0OjI6MCBmdWxsIHNjYWxlIChqcGVnKQotICAgIHsg
UElYX0ZNVF9ZVVZKNDIyUCwgIEJDX1lVVko0MjJQLCAgMSB9LCAvLy88IFBsYW5hciBZVVYgNDoy
OjIgZnVsbCBzY2FsZSAoanBlZykKLSAgICB7IFBJWF9GTVRfWVVWSjQ0NFAsICBCQ19ZVVZKNDQ0
UCwgIDEgfSwgLy8vPCBQbGFuYXIgWVVWIDQ6NDo0IGZ1bGwgc2NhbGUgKGpwZWcpCisgICAgeyBB
Vl9QSVhfRk1UX1JHQjI0LCAgICAgQkNfUkdCODg4LCAgICAxIH0sIC8vLzwgUGFja2VkIHBpeGVs
LCAzIGJ5dGVzIHBlciBwaXhlbCwgUkdCUkdCLi4uCisgICAgeyBBVl9QSVhfRk1UX0JHUjI0LCAg
ICAgQkNfQkdSODg4LCAgICAxIH0sIC8vLzwgUGFja2VkIHBpeGVsLCAzIGJ5dGVzIHBlciBwaXhl
bCwgQkdSQkdSLi4uCisgICAgeyBBVl9QSVhfRk1UX1lVVjQyMlAsICAgQkNfWVVWNDIyUCwgICAx
IH0sIC8vLzwgUGxhbmFyIFlVViA0OjI6MiAoMSBDciAmIENiIHNhbXBsZSBwZXIgMngxIFkgc2Ft
cGxlcykKKyAgICB7IEFWX1BJWF9GTVRfWVVWNDQ0UCwgICBCQ19ZVVY0NDRQLCAgIDEgfSwgLy8v
PCBQbGFuYXIgWVVWIDQ6NDo0ICgxIENyICYgQ2Igc2FtcGxlIHBlciAxeDEgWSBzYW1wbGVzKQor
ICAgIHsgQVZfUElYX0ZNVF9ZVVY0MTFQLCAgIEJDX1lVVjQxMVAsICAgMSB9LCAvLy88IFBsYW5h
ciBZVVYgNDoxOjEgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDR4MSBZIHNhbXBsZXMpCisgICAgeyBB
Vl9QSVhfRk1UX1lVVjQyMlAxNiwgQkNfWVVWNDIyUDE2LCAxIH0sIC8vLzwgUGxhbmFyIDE2IGJp
dCBZVVYgNDoyOjIgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDJ4MSBZIHNhbXBsZXMpCisjaWZkZWYg
QVZfUElYX0ZNVF9ZVVY0MjJQMTAKKyAgICB7IEFWX1BJWF9GTVRfWVVWNDIyUDEwLCBCQ19ZVVY0
MjJQMTAsIDEgfSwgLy8vPCAxMCBiaXQgc2FtcGxlcyBpbiB1aW50MTZfdCBjb250YWluZXJzLCBw
bGFuYXIgNDoyOjIKKyNlbmRpZgorICAgIHsgQVZfUElYX0ZNVF9SR0I1NjUsICAgIEJDX1JHQjU2
NSwgICAgMSB9LCAvLy88IGFsd2F5cyBzdG9yZWQgaW4gY3B1IGVuZGlhbm5lc3MKKyAgICB7IEFW
X1BJWF9GTVRfWVVWSjQyMFAsICBCQ19ZVVZKNDIwUCwgIDEgfSwgLy8vPCBQbGFuYXIgWVVWIDQ6
MjowIGZ1bGwgc2NhbGUgKGpwZWcpCisgICAgeyBBVl9QSVhfRk1UX1lVVko0MjJQLCAgQkNfWVVW
SjQyMlAsICAxIH0sIC8vLzwgUGxhbmFyIFlVViA0OjI6MiBmdWxsIHNjYWxlIChqcGVnKQorICAg
IHsgQVZfUElYX0ZNVF9ZVVZKNDQ0UCwgIEJDX1lVVko0NDRQLCAgMSB9LCAvLy88IFBsYW5hciBZ
VVYgNDo0OjQgZnVsbCBzY2FsZSAoanBlZykKICNpZiBMSUJBVlVUSUxfVkVSU0lPTl9JTlQgPCAo
NTA8PDE2KQotICAgIHsgUElYX0ZNVF9SR0JBMzIsICAgIEJDX1JHQkE4ODg4LCAgMCB9LCAvLy88
IFBhY2tlZCBwaXhlbCwgNCBieXRlcyBwZXIgcGl4ZWwsIEJHUkFCR1JBLi4uCisgICAgeyBBVl9Q
SVhfRk1UX1JHQkEzMiwgICAgQkNfUkdCQTg4ODgsICAwIH0sIC8vLzwgUGFja2VkIHBpeGVsLCA0
IGJ5dGVzIHBlciBwaXhlbCwgQkdSQUJHUkEuLi4KICNlbHNlCi0gICAgeyBQSVhfRk1UX1JHQjMy
LCAgICAgQkNfUkdCQTg4ODgsICAwIH0sIC8vLzwgUGFja2VkIHBpeGVsLCA0IGJ5dGVzIHBlciBw
aXhlbCwgQkdSQUJHUkEuLi4KKyAgICB7IEFWX1BJWF9GTVRfUkdCMzIsICAgICBCQ19SR0JBODg4
OCwgIDAgfSwgLy8vPCBQYWNrZWQgcGl4ZWwsIDQgYnl0ZXMgcGVyIHBpeGVsLCBCR1JBQkdSQS4u
LgogI2VuZGlmCi0gICAgeyBQSVhfRk1UX1JHQjU1NSwgICAgQkNfUkdCODg4LCAgICAwIH0sIC8v
LzwgYWx3YXlzIHN0b3JlZCBpbiBjcHUgZW5kaWFubmVzcywgbW9zdCBzaWduaWZpY2FudCBiaXQg
dG8gMQotICAgIHsgUElYX0ZNVF9HUkFZOCwgICAgIEJDX1JHQjg4OCwgICAgMCB9LAotICAgIHsg
UElYX0ZNVF9NT05PV0hJVEUsIEJDX1JHQjg4OCwgICAgMCB9LCAvLy88IDAgaXMgd2hpdGUKLSAg
ICB7IFBJWF9GTVRfTU9OT0JMQUNLLCBCQ19SR0I4ODgsICAgIDAgfSwgLy8vPCAwIGlzIGJsYWNr
Ci0gICAgeyBQSVhfRk1UX1BBTDgsICAgICAgQkNfUkdCODg4LCAgICAwIH0sIC8vLzwgOCBiaXQg
d2l0aCBSR0JBIHBhbGV0dGUKLSAgICB7IFBJWF9GTVRfWVVWNDEwUCwgICBCQ19ZVVY0MjBQLCAg
IDAgfSwgLy8vPCBQbGFuYXIgWVVWIDQ6MTowICgxIENyICYgQ2Igc2FtcGxlIHBlciA0eDQgWSBz
YW1wbGVzKQorICAgIHsgQVZfUElYX0ZNVF9SR0I1NTUsICAgIEJDX1JHQjg4OCwgICAgMCB9LCAv
Ly88IGFsd2F5cyBzdG9yZWQgaW4gY3B1IGVuZGlhbm5lc3MsIG1vc3Qgc2lnbmlmaWNhbnQgYml0
IHRvIDEKKyAgICB7IEFWX1BJWF9GTVRfR1JBWTgsICAgICBCQ19SR0I4ODgsICAgIDAgfSwKKyAg
ICB7IEFWX1BJWF9GTVRfTU9OT1dISVRFLCBCQ19SR0I4ODgsICAgIDAgfSwgLy8vPCAwIGlzIHdo
aXRlCisgICAgeyBBVl9QSVhfRk1UX01PTk9CTEFDSywgQkNfUkdCODg4LCAgICAwIH0sIC8vLzwg
MCBpcyBibGFjaworICAgIHsgQVZfUElYX0ZNVF9QQUw4LCAgICAgIEJDX1JHQjg4OCwgICAgMCB9
LCAvLy88IDggYml0IHdpdGggUkdCQSBwYWxldHRlCisgICAgeyBBVl9QSVhfRk1UX1lVVjQxMFAs
ICAgQkNfWVVWNDIwUCwgICAwIH0sIC8vLzwgUGxhbmFyIFlVViA0OjE6MCAoMSBDciAmIENiIHNh
bXBsZSBwZXIgNHg0IFkgc2FtcGxlcykKICAgfTsKIAogc3RhdGljIGNvbnN0IHN0cnVjdApAQCAt
MzQzLDE2ICszNDMsMTYgQEAgc3RhdGljIGludCBscXRfdGVuYml0X2RueGhkX3N1cHBvcnRlZChB
VgogICBpZiAoIWNvZGVjLT5waXhfZm10cykKICAgICByZXR1cm4gMDsKIAotICBmb3IgKGkgPSAw
OyBjb2RlYy0+cGl4X2ZtdHNbaV0gIT0gUElYX0ZNVF9OT05FOyArK2kpCisgIGZvciAoaSA9IDA7
IGNvZGVjLT5waXhfZm10c1tpXSAhPSBBVl9QSVhfRk1UX05PTkU7ICsraSkKICAgICB7Ci0gICAg
aWYgKGNvZGVjLT5waXhfZm10c1tpXSA9PSBQSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSkKKyAg
ICBpZiAoY29kZWMtPnBpeF9mbXRzW2ldID09IEFWX1BJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1Z
KQogICAgICAgcmV0dXJuIDE7CiAgICAgfQogCiAgIHJldHVybiAwOwogICB9CiAKLXN0YXRpYyBl
bnVtIFBpeGVsRm9ybWF0IGxxdF9mZm1wZWdfZ2V0X2ZmbXBlZ19jb2xvcm1vZGVsKGludCBpZCkK
K3N0YXRpYyBlbnVtIEFWUGl4ZWxGb3JtYXQgbHF0X2ZmbXBlZ19nZXRfZmZtcGVnX2NvbG9ybW9k
ZWwoaW50IGlkKQogICB7CiAgIGludCBpOwogCkBAIC0zNjEsMTAgKzM2MSwxMCBAQCBzdGF0aWMg
ZW51bSBQaXhlbEZvcm1hdCBscXRfZmZtcGVnX2dldF9mCiAgICAgaWYoY29sb3Jtb2RlbHNbaV0u
bHF0X2lkID09IGlkKQogICAgICAgcmV0dXJuIGNvbG9ybW9kZWxzW2ldLmZmbXBlZ19pZDsKICAg
ICB9Ci0gIHJldHVybiBQSVhfRk1UX05COworICByZXR1cm4gQVZfUElYX0ZNVF9OQjsKICAgfQog
Ci1zdGF0aWMgaW50IGxxdF9mZm1wZWdfZ2V0X2xxdF9jb2xvcm1vZGVsKGVudW0gUGl4ZWxGb3Jt
YXQgaWQsIGludCAqIGV4YWN0KQorc3RhdGljIGludCBscXRfZmZtcGVnX2dldF9scXRfY29sb3Jt
b2RlbChlbnVtIEFWUGl4ZWxGb3JtYXQgaWQsIGludCAqIGV4YWN0KQogICB7CiAgIGludCBpOwog
CkBAIC00MDIsMjQgKzQwMiwyNCBAQCBzdGF0aWMgdm9pZCBscXRfZmZtcGVnX3NldHVwX2RlY29k
aW5nX2NvCiAgIC8qIEZpcnN0IHdlIHRyeSBjb2RlYy1zcGVjaWZpYyBjb2xvcm1vZGVsIG1hdGNo
aW5nLiAqLwogICBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfRE5YSEQpCiAg
ICAgewotICAgIC8qIEZGTXBlZyBzdXBwb3J0cyBQSVhfRk1UX1lVVjQyMlAgYW5kIFBJWF9GTVRf
WVVWNDIyUDEwIGZvciBETnhIRCwgd2hpY2gKLSAgICAgICB3ZSBzb21ldGltZXMgaW50ZXJwcmV0
IGFzIFBJWF9GTVRfWVVWSjQyMlAgYW5kIFBJWF9GTVRfWVVWSjQyMlAxMC4gKi8KLSAgICBpZiAo
Y29kZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfWVVWNDIyUCB8fCBjb2RlYy0+YXZjdHgt
PnBpeF9mbXQgPT0gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkpCisgICAgLyogRkZNcGVnIHN1
cHBvcnRzIEFWX1BJWF9GTVRfWVVWNDIyUCBhbmQgQVZfUElYX0ZNVF9ZVVY0MjJQMTAgZm9yIERO
eEhELCB3aGljaAorICAgICAgIHdlIHNvbWV0aW1lcyBpbnRlcnByZXQgYXMgQVZfUElYX0ZNVF9Z
VVZKNDIyUCBhbmQgQVZfUElYX0ZNVF9ZVVZKNDIyUDEwLiAqLworICAgIGlmIChjb2RlYy0+YXZj
dHgtPnBpeF9mbXQgPT0gQVZfUElYX0ZNVF9ZVVY0MjJQIHx8IGNvZGVjLT5hdmN0eC0+cGl4X2Zt
dCA9PSBBVl9QSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSkKICAgICAgIHsKLSAgICAgIGludCBw
MTAgPSAoY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1Z
KTsKKyAgICAgIGludCBwMTAgPSAoY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IEFWX1BJWF9GTVRf
WVVWNDIyUDEwX09SX0RVTU1ZKTsKICAgICAgICpleGFjdCA9IDE7CiAgICAgICBpZiAobHF0X2Zm
bXBlZ19nZXRfYXZpZF95dXZfcmFuZ2UodnRyYWNrLT50cmFjaykgPT0gQVZJRF9GVUxMX1lVVl9S
QU5HRSkKICAgICAgICAgewogICAgICAgICB2dHJhY2stPnN0cmVhbV9jbW9kZWwgPSBwMTAgPyBC
Q19ZVVZKNDIyUDEwIDogQkNfWVVWSjQyMlA7Ci0gICAgICAgIGNvZGVjLT5yZWludGVycHJldF9w
aXhfZm10ID0gcDEwID8gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgOiBQSVhfRk1UX1lVVko0
MjJQOwotICAgICAgICAvLyBOb3RlOiByZWludGVycHJldF9waXhfZm10IHNob3VsZCByZWFsbHkg
YmUgUElYX0ZNVF9ZVVZKNDIyUDEwLCBleGNlcHQKKyAgICAgICAgY29kZWMtPnJlaW50ZXJwcmV0
X3BpeF9mbXQgPSBwMTAgPyBBVl9QSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSA6IEFWX1BJWF9G
TVRfWVVWSjQyMlA7CisgICAgICAgIC8vIE5vdGU6IHJlaW50ZXJwcmV0X3BpeF9mbXQgc2hvdWxk
IHJlYWxseSBiZSBBVl9QSVhfRk1UX1lVVko0MjJQMTAsIGV4Y2VwdAogICAgICAgICAvLyB0aGVy
ZSBpcyBubyBzdWNoIGNvbG9ybW9kZWwgaW4gRkZNcGVnLiBGb3J0dW5hdGVseSwgaXQncyBub3Qg
YSBwcm9ibGVtCiAgICAgICAgIC8vIGluIHRoaXMgY2FzZSwgYXMgcmVpbnRlcnByZXRfcGl4X2Zt
dCBpcyBvbmx5IHVzZWQgd2hlbiAqZXhhY3QgPT0gMC4KICAgICAgICAgfQogICAgICAgZWxzZQog
ICAgICAgICB7CiAgICAgICAgIHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9IHAxMCA/IEJDX1lVVjQy
MlAxMCA6IEJDX1lVVjQyMlA7Ci0gICAgICAgIGNvZGVjLT5yZWludGVycHJldF9waXhfZm10ID0g
cDEwID8gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgOiBQSVhfRk1UX1lVVjQyMlA7CisgICAg
ICAgIGNvZGVjLT5yZWludGVycHJldF9waXhfZm10ID0gcDEwID8gQVZfUElYX0ZNVF9ZVVY0MjJQ
MTBfT1JfRFVNTVkgOiBBVl9QSVhfRk1UX1lVVjQyMlA7CiAgICAgICAgIH0KICAgICAgIHJldHVy
bjsKICAgICAgIH0KQEAgLTQ0MCwxNCArNDQwLDE0IEBAIHN0YXRpYyB2b2lkIGxxdF9mZm1wZWdf
c2V0dXBfZW5jb2RpbmdfY28KIAogICBpZiAoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVD
X0lEX0ROWEhEKQogICAgIHsKLSAgICAvKiBGRk1wZWcncyBETnhIRCBlbmNvZGVyIG9ubHkgc3Vw
cG9ydHMgUElYX0ZNVF9ZVVY0MjJQIGFuZCBQSVhfRk1UX1lVVjQyMlAxMAotICAgICAgIGFuZCBk
b2Vzbid0IGtub3cgYW55dGhpbmcgYWJvdXQgUElYX0ZNVF9ZVVZKNDIyUCBhbmQgUElYX0ZNVF9Z
VVZKNDIyUDEwCisgICAgLyogRkZNcGVnJ3MgRE54SEQgZW5jb2RlciBvbmx5IHN1cHBvcnRzIEFW
X1BJWF9GTVRfWVVWNDIyUCBhbmQgQVZfUElYX0ZNVF9ZVVY0MjJQMTAKKyAgICAgICBhbmQgZG9l
c24ndCBrbm93IGFueXRoaW5nIGFib3V0IEFWX1BJWF9GTVRfWVVWSjQyMlAgYW5kIEFWX1BJWF9G
TVRfWVVWSjQyMlAxMAogICAgICAgIChpbiBmYWN0LCB0aGUgbGF0dGVyIGRvZXNuJ3QgZXZlbiBl
eGlzdCkgKi8KLSAgICBjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPSBQSVhfRk1UX1lVVjQyMlA7Cisg
ICAgY29kZWMtPmF2Y3R4LT5waXhfZm10ID0gQVZfUElYX0ZNVF9ZVVY0MjJQOwogICAgIGlmICh2
dHJhY2stPnN0cmVhbV9jbW9kZWwgPT0gQkNfWVVWNDIyUDEwIHx8IHZ0cmFjay0+c3RyZWFtX2Nt
b2RlbCA9PSBCQ19ZVVZKNDIyUDEwKQogICAgICAgewogICAgICAgaWYgKGxxdF90ZW5iaXRfZG54
aGRfc3VwcG9ydGVkKGNvZGVjLT5lbmNvZGVyKSkKLSAgICAgICAgY29kZWMtPmF2Y3R4LT5waXhf
Zm10ID0gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVk7CisgICAgICAgIGNvZGVjLT5hdmN0eC0+
cGl4X2ZtdCA9IEFWX1BJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1ZOwogICAgICAgfQogICAgIH0K
ICAgfQpAQCAtNDU4LDcgKzQ1OCw3IEBAIHN0YXRpYyB2b2lkIGxxdF9mZm1wZWdfc2V0dXBfZW5j
b2RpbmdfY28KIC8qIEZyb20gYXZjb2RlYy5oOiAqLwogCiAvKgotICogUElYX0ZNVF9SR0JBMzIg
aXMgaGFuZGxlZCBpbiBhbiBlbmRpYW4tc3BlY2lmaWMgbWFubmVyLiBBIFJHQkEKKyAqIEFWX1BJ
WF9GTVRfUkdCQTMyIGlzIGhhbmRsZWQgaW4gYW4gZW5kaWFuLXNwZWNpZmljIG1hbm5lci4gQSBS
R0JBCiAgKiBjb2xvciBpcyBwdXQgdG9nZXRoZXIgYXM6CiAgKiAgKEEgPDwgMjQpIHwgKFIgPDwg
MTYpIHwgKEcgPDwgOCkgfCBCCiAgKiBUaGlzIGlzIHN0b3JlZCBhcyBCR1JBIG9uIGxpdHRsZSBl
bmRpYW4gQ1BVIGFyY2hpdGVjdHVyZXMgYW5kIEFSR0Igb24KQEAgLTUzMCw3ICs1MzAsNyBAQCBz
dGF0aWMgdm9pZCBjb252ZXJ0X3JnYmFfdG9fYXJnYih1aW50OF90CiAgKi8KIAogc3RhdGljIHZv
aWQgY29udmVydF9pbWFnZV9kZWNvZGUocXVpY2t0aW1lX2ZmbXBlZ192aWRlb19jb2RlY190ICpj
b2RlYywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFWRnJhbWUgKiBpbl9mcmFt
ZSwgZW51bSBQaXhlbEZvcm1hdCBpbl9mb3JtYXQsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBBVkZyYW1lICogaW5fZnJhbWUsIGVudW0gQVZQaXhlbEZvcm1hdCBpbl9mb3JtYXQs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBjaGFyICoqIG91dF9m
cmFtZSwgaW50IG91dF9mb3JtYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgd2lkdGgsIGludCBoZWlnaHQsIGludCByb3dfc3BhbiwgaW50IHJvd19zcGFuX3V2KQogICB7
CkBAIC01NDcsOSArNTQ3LDkgQEAgc3RhdGljIHZvaWQgY29udmVydF9pbWFnZV9kZWNvZGUocXVp
Y2t0aQogICAgKiAgUkdCQSBmb3JtYXQgbGlrZSBpbiBmZm1wZWc/PwogICAgKi8KICNpZiBMSUJB
VlVUSUxfVkVSU0lPTl9JTlQgPCAoNTA8PDE2KQotICBpZigoaW5fZm9ybWF0ID09IFBJWF9GTVRf
UkdCQTMyKSAmJiAob3V0X2Zvcm1hdCA9PSBCQ19SR0JBODg4OCkpCisgIGlmKChpbl9mb3JtYXQg
PT0gQVZfUElYX0ZNVF9SR0JBMzIpICYmIChvdXRfZm9ybWF0ID09IEJDX1JHQkE4ODg4KSkKICNl
bHNlCi0gICAgaWYoKGluX2Zvcm1hdCA9PSBQSVhfRk1UX1JHQjMyKSAmJiAob3V0X2Zvcm1hdCA9
PSBCQ19SR0JBODg4OCkpCisgICAgaWYoKGluX2Zvcm1hdCA9PSBBVl9QSVhfRk1UX1JHQjMyKSAm
JiAob3V0X2Zvcm1hdCA9PSBCQ19SR0JBODg4OCkpCiAjZW5kaWYKICAgICAgIHsKICAgICAgIGNv
bnZlcnRfaW1hZ2VfZGVjb2RlX3JnYmEoaW5fZnJhbWUsIG91dF9mcmFtZSwgd2lkdGgsIGhlaWdo
dCwgY29kZWMtPnlfb2Zmc2V0KTsKQEAgLTgyOSw3ICs4MjksNyBAQCBzdGF0aWMgaW50IGxxdF9m
Zm1wZWdfZGVjb2RlX3ZpZGVvKHF1aWNrCiAgICAgaWYoYXZjb2RlY19vcGVuMihjb2RlYy0+YXZj
dHgsIGNvZGVjLT5kZWNvZGVyLCBOVUxMKSAhPSAwKQogICAgICAgcmV0dXJuIC0xOwogI2VuZGlm
Ci0gICAgY29kZWMtPmZyYW1lID0gYXZjb2RlY19hbGxvY19mcmFtZSgpOworICAgIGNvZGVjLT5m
cmFtZSA9IGF2X2ZyYW1lX2FsbG9jKCk7CiAgICAgdnRyYWNrLT5zdHJlYW1fY21vZGVsID0gTFFU
X0NPTE9STU9ERUxfTk9ORTsKICAgICBjb2RlYy0+aW5pdGlhbGl6ZWQgPSAxOwogICAgIH0KQEAg
LTkyOSwxMCArOTI5LDEwIEBAIHN0YXRpYyBpbnQgbHF0X2ZmbXBlZ19kZWNvZGVfdmlkZW8ocXVp
Y2sKICNpZmRlZiBIQVZFX0xJQlNXU0NBTEUKIAogI2lmIExJQkFWVVRJTF9WRVJTSU9OX0lOVCA8
ICg1MDw8MTYpCi0gICAgICBpZighKChjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPT0gUElYX0ZNVF9S
R0JBMzIpICYmCisgICAgICBpZighKChjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPT0gQVZfUElYX0ZN
VF9SR0JBMzIpICYmCiAgICAgICAgICAgICh2dHJhY2stPnN0cmVhbV9jbW9kZWwgPT0gQkNfUkdC
QTg4ODgpKSkKICNlbHNlCi0gICAgICAgIGlmKCEoKGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBQ
SVhfRk1UX1JHQjMyKSAmJgorICAgICAgICBpZighKChjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPT0g
QVZfUElYX0ZNVF9SR0IzMikgJiYKICAgICAgICAgICAgICAodnRyYWNrLT5zdHJlYW1fY21vZGVs
ID09IEJDX1JHQkE4ODg4KSkpCiAjZW5kaWYKICAgICAgICAgICB7CkBAIC0xMzE4LDcgKzEzMTgs
NyBAQCBzdGF0aWMgaW50IGxxdF9mZm1wZWdfZW5jb2RlX3ZpZGVvKHF1aWNrCiAgICAgICAgIAog
ICBpZighY29kZWMtPmluaXRpYWxpemVkKQogICAgIHsKLSAgICBjb2RlYy0+ZnJhbWUgPSBhdmNv
ZGVjX2FsbG9jX2ZyYW1lKCk7CisgICAgY29kZWMtPmZyYW1lID0gYXZfZnJhbWVfYWxsb2MoKTsK
IAogICAgIC8qIHRpbWVfYmFzZSBpcyAxL2ZyYW1lcmF0ZSBmb3IgY29uc3RhbnQgZnJhbWVyYXRl
ICovCiAgICAgICAgICAgCkBAIC0xMzk2LDkgKzEzOTYsOSBAQCBzdGF0aWMgaW50IGxxdF9mZm1w
ZWdfZW5jb2RlX3ZpZGVvKHF1aWNrCiAgICAgICBpZih2dHJhY2stPnN0cmVhbV9jbW9kZWwgPT0g
QkNfUkdCQTg4ODgpCiAgICAgICAgIHsKICAgICAgICAgLyogTGlicXVpY2t0aW1lIGRvZXNuJ3Qg
bmF0aXZlbHkgc3VwcG9ydCBhIGNvbG9yIG1vZGVsIGVxdWl2YWxlbnQKLSAgICAgICAgICAgdG8g
UElYX0ZNVF9BUkdCLCB3aGljaCBpcyByZXF1aXJlZCBmb3IgUVRSTEUgd2l0aCBhbHBoYSBjaGFu
bmVsLgorICAgICAgICAgICB0byBBVl9QSVhfRk1UX0FSR0IsIHdoaWNoIGlzIHJlcXVpcmVkIGZv
ciBRVFJMRSB3aXRoIGFscGhhIGNoYW5uZWwuCiAgICAgICAgICAgIFNvLCB3ZSB1c2UgQkNfUkdC
QTg4ODggYW5kIGRvIGFkIGhvYyBjb252ZXJzaW9uIGJlbG93LiAqLwotICAgICAgICBjb2RlYy0+
YXZjdHgtPnBpeF9mbXQgPSBQSVhfRk1UX0FSR0I7CisgICAgICAgIGNvZGVjLT5hdmN0eC0+cGl4
X2ZtdCA9IEFWX1BJWF9GTVRfQVJHQjsKICAgICAgICAgdnRyYWNrLT50cmFjay0+bWRpYS5taW5m
LnN0Ymwuc3RzZC50YWJsZVswXS5kZXB0aCA9IDMyOwogICAgICAgICB9CiAgICAgICB9CkBAIC0x
NDY3LDcgKzE0NjcsNyBAQCBzdGF0aWMgaW50IGxxdF9mZm1wZWdfZW5jb2RlX3ZpZGVvKHF1aWNr
CiAgICAgfQogICAvLyAgICAgICAgY29kZWMtPmxxdF9jb2xvcm1vZGVsID0gZmZtZXBnXzJfbHF0
KGNvZGVjLT5jb20uZmZjb2RlY19lbmMpOwogCi0gIGlmKGNvZGVjLT55X29mZnNldCAhPSAwIHx8
IGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBQSVhfRk1UX0FSR0IpCisgIGlmKGNvZGVjLT55X29m
ZnNldCAhPSAwIHx8IGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBBVl9QSVhfRk1UX0FSR0IpCiAg
ICAgewogICAgIGlmKCFjb2RlYy0+dG1wX3Jvd3MpCiAgICAgICB7CkBAIC0xNDkyLDcgKzE0OTIs
NyBAQCBzdGF0aWMgaW50IGxxdF9mZm1wZWdfZW5jb2RlX3ZpZGVvKHF1aWNrCiAgICAgICAgICAg
ICAgICAgICAgICAgICB2dHJhY2stPnN0cmVhbV9jbW9kZWwsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAwLCAwLCAwLCBjb2RlYy0+eV9vZmZzZXQpOwogICAgICAgfQotICAgIGVsc2UgaWYoY29k
ZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfQVJHQikKKyAgICBlbHNlIGlmKGNvZGVjLT5h
dmN0eC0+cGl4X2ZtdCA9PSBBVl9QSVhfRk1UX0FSR0IpCiAgICAgICB7CiAgICAgICBjb252ZXJ0
X3JnYmFfdG9fYXJnYihyb3dfcG9pbnRlcnNbMF0sIHZ0cmFjay0+c3RyZWFtX3Jvd19zcGFuLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZWMtPnRtcF9yb3dzWzBdLCBjb2RlYy0+dG1w
X3Jvd19zcGFuLApJbmRleDogbGlicXVpY2t0aW1lLTEuMi40L3BsdWdpbnMvZmZtcGVnL2F1ZGlv
LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQotLS0gbGlicXVpY2t0aW1lLTEuMi40Lm9yaWcvcGx1Z2lucy9mZm1wZWcv
YXVkaW8uYworKysgbGlicXVpY2t0aW1lLTEuMi40L3BsdWdpbnMvZmZtcGVnL2F1ZGlvLmMKQEAg
LTEyNjYsNyArMTI2Niw3IEBAIHN0YXRpYyBpbnQgbHF0X2ZmbXBlZ19lbmNvZGVfYXVkaW8ocXVp
Y2sKICAgICBwa3QuZGF0YSA9IGNvZGVjLT5jaHVua19idWZmZXI7CiAgICAgcGt0LnNpemUgPSBj
b2RlYy0+Y2h1bmtfYnVmZmVyX2FsbG9jOwogCi0gICAgYXZjb2RlY19nZXRfZnJhbWVfZGVmYXVs
dHMoJmYpOworICAgIGF2X2ZyYW1lX3VucmVmKCZmKTsKICAgICBmLm5iX3NhbXBsZXMgPSBjb2Rl
Yy0+YXZjdHgtPmZyYW1lX3NpemU7CiAgICAgCiAgICAgYXZjb2RlY19maWxsX2F1ZGlvX2ZyYW1l
KCZmLCBjaGFubmVscywgY29kZWMtPmF2Y3R4LT5zYW1wbGVfZm10LAotLS0gbGlicXVpY2t0aW1l
LTEuMi40L3BsdWdpbnMvZmZtcGVnL2xxdF9mZm1wZWcuYy5vcmlnCTIwMTYtMDItMTcgMDg6MTE6
NTAuNjgzMDIzNjEyICswMDAwCisrKyBsaWJxdWlja3RpbWUtMS4yLjQvcGx1Z2lucy9mZm1wZWcv
bHF0X2ZmbXBlZy5jCTIwMTYtMDItMTcgMDg6MTI6MjAuMzYyODk4OTc0ICswMDAwCkBAIC0zNzAs
NyArMzcwLDcgQEAKIHN0cnVjdCBDT0RFQ0lETUFQIGNvZGVjaWRtYXBfdltdID0KICAgewogICAg
IHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01QRUcxVklERU8sCisgICAgICAuaWQgPSBBVl9DT0RF
Q19JRF9NUEVHMVZJREVPLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5V
TEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC0zODEsNyArMzgxLDcgQEAKICAgICAgIC53
YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfQogICAgIH0sCiAgICAgewotICAgICAgLmlkID0g
Q09ERUNfSURfTVBFRzQsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NUEVHNCwKICAgICAgIC5p
bmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxM
LApAQCAtMzk5LDcgKzM5OSw3IEBACiAgICAgICAuY29tcHJlc3Npb25faWQgPSBMUVRfQ09NUFJF
U1NJT05fTVBFRzRfQVNQLAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfTVNN
UEVHNFYxLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfTVNNUEVHNFYxLAogICAgICAgLmluZGV4
ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBA
IC00MTAsNyArNDEwLDcgQEAKICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfSwK
ICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01TTVBFRzRWMiwKKyAgICAgIC5p
ZCA9IEFWX0NPREVDX0lEX01TTVBFRzRWMiwKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVu
Y29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNDIxLDcgKzQyMSw3IEBA
CiAgICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0g
ICAgICAuaWQgPSBDT0RFQ19JRF9NU01QRUc0VjMsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9N
U01QRUc0VjMsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAg
ICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTQzNyw3ICs0MzcsNyBAQAogICAgICAgLmRvX2VuY29k
ZSA9IDEsCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9NU01QRUc0VjMsCisg
ICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NU01QRUc0VjMsCiAgICAgICAuaW5kZXggPSAtMSwKICAg
ICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTQ1Miw3ICs0
NTIsNyBAQAogICAgIH0sCiAjaWYgMAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX1dNVjEs
CisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9XTVYxLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAg
ICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC00NjUsNyArNDY1
LDcgQEAKICAgICB9LAogI2VuZGlmCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfSDI2MywK
KyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0gyNjMsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAg
IC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTQ3Nyw3ICs0Nzcs
NyBAQAogICAgICAgLmNvbXBhdGliaWxpdHlfZmxhZ3MgPSBMUVRfRklMRV9RVF9PTEQgfCBMUVRf
RklMRV9RVCB8IExRVF9GSUxFX01QNCB8IExRVF9GSUxFXzNHUCwKICAgICB9LAogICAgIHsKLSAg
ICAgIC5pZCA9IENPREVDX0lEX0gyNjMsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9IMjYzLAog
ICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2Rl
ciA9IE5VTEwsCkBAIC00OTIsNyArNDkyLDcgQEAKICAgICAgIC5kb19lbmNvZGUgPSAxLAogICAg
IH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfSDI2NCwKKyAgICAgIC5pZCA9IEFWX0NP
REVDX0lEX0gyNjQsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwK
ICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTUwMyw3ICs1MDMsNyBAQAogICAgICAgLndhdl9p
ZHMgPSB7IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09E
RUNfSURfSDI2M1AsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9IMjYzUCwKICAgICAgIC5pbmRl
eCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApA
QCAtNTE3LDcgKzUxNyw3IEBACiAgICAgICAuZG9fZW5jb2RlID0gMSwKICAgICB9LAogICAgIHsK
LSAgICAgIC5pZCA9IENPREVDX0lEX0gyNjNJLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfSDI2
M0ksCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5k
ZWNvZGVyID0gTlVMTCwKQEAgLTUyOCw3ICs1MjgsNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExR
VF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfU1ZR
MSwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX1NWUTEsCiAgICAgICAuaW5kZXggPSAtMSwKICAg
ICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTUzOSw3ICs1
MzksNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAg
ICAgewotICAgICAgLmlkID0gQ09ERUNfSURfU1ZRMywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lE
X1NWUTMsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAg
IC5kZWNvZGVyID0gTlVMTCwKQEAgLTU1MCw3ICs1NTAsNyBAQAogICAgICAgLndhdl9pZHMgPSB7
IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURf
TUpQRUcsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NSlBFRywKICAgICAgIC5pbmRleCA9IC0x
LAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNTY0
LDcgKzU2NCw3IEBACiAgICAgICAuZG9fZW5jb2RlID0gMSwKICAgICB9LAogICAgIHsKLSAgICAg
IC5pZCA9IENPREVDX0lEX01KUEVHQiwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01KUEVHQiwK
ICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29k
ZXIgPSBOVUxMLApAQCAtNTc4LDcgKzU3OCw3IEBACiAgICAgfSwKICNpZiBMSUJBVkNPREVDX0JV
SUxEID49IDMzNDY2ODgKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9UQVJHQSwKKyAgICAg
IC5pZCA9IEFWX0NPREVDX0lEX1RBUkdBLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5j
b2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC01OTAsNyArNTkwLDcgQEAK
ICNlbmRpZgogI2lmIExJQkFWQ09ERUNfQlVJTEQgPj0gMzM0NzQ1NgogICAgIHsKLSAgICAgIC5p
ZCA9IENPREVDX0lEX1RJRkYsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9USUZGLAogICAgICAg
LmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5V
TEwsCkBAIC02MDEsNyArNjAxLDcgQEAKICAgICB9LAogI2VuZGlmCiAgICAgewotICAgICAgLmlk
ID0gQ09ERUNfSURfOEJQUywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEXzhCUFMsCiAgICAgICAu
aW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVM
TCwKQEAgLTYxMSw3ICs2MTEsNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZfSURfTk9O
RSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfSU5ERU8zLAorICAgICAg
LmlkID0gQVZfQ09ERUNfSURfSU5ERU8zLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5j
b2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC02MjIsNyArNjIyLDcgQEAK
ICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfSwKICAgICB9LAogICAgIHsKLSAg
ICAgIC5pZCA9IENPREVDX0lEX1JQWkEsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9SUFpBLAog
ICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2Rl
ciA9IE5VTEwsCkBAIC02MzIsNyArNjMyLDcgQEAKICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FW
X0lEX05PTkUgfSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX1NNQywKKyAg
ICAgIC5pZCA9IEFWX0NPREVDX0lEX1NNQywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVu
Y29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNjQyLDcgKzY0Miw3IEBA
CiAgICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0g
ICAgICAuaWQgPSBDT0RFQ19JRF9DSU5FUEFLLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfQ0lO
RVBBSywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAg
LmRlY29kZXIgPSBOVUxMLApAQCAtNjUzLDcgKzY1Myw3IEBACiAgICAgICAud2F2X2lkcyA9IHsg
TFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9D
WVVWLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfQ1lVViwKICAgICAgIC5pbmRleCA9IC0xLAog
ICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNjY0LDcg
KzY2NCw3IEBACiAgICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwK
ICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9RVFJMRSwKKyAgICAgIC5pZCA9IEFWX0NPREVD
X0lEX1FUUkxFLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAg
ICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC02NzcsNyArNjc3LDcgQEAKICAgICAgIC5lbmNvZGlu
Z19jb2xvcm1vZGVscyA9IChpbnRbXSl7IEJDX1JHQjg4OCwgQkNfUkdCQTg4ODgsIExRVF9DT0xP
Uk1PREVMX05PTkUgfSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01TUkxF
LAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfTVNSTEUsCiAgICAgICAuaW5kZXggPSAtMSwKICAg
ICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTY4Nyw3ICs2
ODcsNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAg
ICAgewotICAgICAgLmlkID0gQ09ERUNfSURfRFZWSURFTywKKyAgICAgIC5pZCA9IEFWX0NPREVD
X0lEX0RWVklERU8sCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwK
ICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTcwMyw3ICs3MDMsNyBAQAogICAgICAgLmltYWdl
X3NpemVzID0gaW1hZ2Vfc2l6ZXNfZHYsCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RF
Q19JRF9EVlZJREVPLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfRFZWSURFTywKICAgICAgIC5p
bmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxM
LApAQCAtNzE5LDcgKzcxOSw3IEBACiAgICAgICAuaW1hZ2Vfc2l6ZXMgPSBpbWFnZV9zaXplc19k
diwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX0RWVklERU8sCisgICAgICAu
aWQgPSBBVl9DT0RFQ19JRF9EVlZJREVPLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5j
b2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC03MzUsNyArNzM1LDcgQEAK
ICAgICB9LAogICAgIC8qIERWQ1BSTyBIRCAoZGVjb2Rpbmcgb25seSBmb3Igbm93KSAqLwogICAg
IHsKLSAgICAgIC5pZCA9IENPREVDX0lEX0RWVklERU8sCisgICAgICAuaWQgPSBBVl9DT0RFQ19J
RF9EVlZJREVPLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAg
ICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC03NTYsNyArNzU2LDcgQEAKICAgICAgIC8vIC5kb19l
bmNvZGUgPSAxCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9GRlZIVUZGLAor
ICAgICAgLmlkID0gQVZfQ09ERUNfSURfRkZWSFVGRiwKICAgICAgIC5pbmRleCA9IC0xLAogICAg
ICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNzY5LDcgKzc2
OSw3IEBACiAgICAgICAuZG9fZW5jb2RlID0gMQogICAgIH0sCiAgICAgewotICAgICAgLmlkID0g
Q09ERUNfSURfRkZWMSwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0ZGVjEsCiAgICAgICAuaW5k
ZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwK
QEAgLTc4NSw3ICs3ODUsNyBAQAogICAgIH0sCiAjaWYgTElCQVZDT0RFQ19CVUlMRCA+PSAzMzUy
NTc2CiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfRE5YSEQsCisgICAgICAuaWQgPSBBVl9D
T0RFQ19JRF9ETlhIRCwKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxM
LAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtODAxLDcgKzgwMSw3IEBACiAgICAgfSwKICNl
bmRpZgogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01QRUcyVklERU8sCisgICAgICAuaWQg
PSBBVl9DT0RFQ19JRF9NUEVHMlZJREVPLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5j
b2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC04MjMsNyArODIzLDcgQEAK
IHN0cnVjdCBDT0RFQ0lETUFQIGNvZGVjaWRtYXBfYVtdID0KICAgewogICAgIHsKLSAgICAgIC5p
ZCA9IENPREVDX0lEX01QMywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01QMywKICAgICAgIC5p
bmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxM
LApAQCAtODM1LDcgKzgzNSw3IEBACiAgICAgICAud2F2X2lkcyA9IHsgMHg1MCwgMHg1NSwgTFFU
X1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9NUDIs
CisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NUDIsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAg
IC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTg1MCw3ICs4NTAs
NyBAQAogICAgICAgLmNvbXByZXNzaW9uX2lkID0gTFFUX0NPTVBSRVNTSU9OX01QMiwKICAgICB9
LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX0FDMywKKyAgICAgIC5pZCA9IEFWX0NPREVD
X0lEX0FDMywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAg
ICAgLmRlY29kZXIgPSBOVUxMLApAQCAtODY1LDcgKzg2NSw3IEBACiAgICAgICAuY29tcHJlc3Np
b25faWQgPSBMUVRfQ09NUFJFU1NJT05fQUMzLAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0g
Q09ERUNfSURfUURNMiwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX1FETTIsCiAgICAgICAuaW5k
ZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwK
QEAgLTg4MCw3ICs4ODAsNyBAQAogI2lmIDEKICAgICAvKiBEb2Vzbid0IHdvcmsgYXMgbG9uZyBh
cyBhdWRpbyBjaHVua3MgYXJlIG5vdCBzcGxpdCBpbnRvIFZCUiAiU2FtcGxlcyIgKi8KICAgICB7
Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9BTEFDLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfQUxB
QywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRl
Y29kZXIgPSBOVUxMLApAQCAtODkzLDcgKzg5Myw3IEBACiAjaWYgMQogICAgIC8qIFNvdW5kcyB1
Z2x5ICovCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfQURQQ01fTVMsCisgICAgICAuaWQg
PSBBVl9DT0RFQ19JRF9BRFBDTV9NUywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29k
ZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtOTA2LDcgKzkwNiw3IEBACiAj
aWYgMQogICAgIC8qIFNvdW5kcyB1Z2x5ICovCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURf
QURQQ01fSU1BX1dBViwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0FEUENNX0lNQV9XQVYsCiAg
ICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVy
ID0gTlVMTCwKLS0tIGxpYnF1aWNrdGltZS0xLjIuNC9wbHVnaW5zL2ZmbXBlZy92aWRlby5jLm9y
aWcJMjAxNi0wMi0xNyAwODoxNDoxOC41ODU3MzU2MjIgKzAwMDAKKysrIGxpYnF1aWNrdGltZS0x
LjIuNC9wbHVnaW5zL2ZmbXBlZy92aWRlby5jCTIwMTYtMDItMTcgMDg6MTQ6MzUuMzMyMzMxOTAw
ICswMDAwCkBAIC00MDAsNyArNDAwLDcgQEAKICAgY29kZWMtPnJlaW50ZXJwcmV0X3BpeF9mbXQg
PSBjb2RlYy0+YXZjdHgtPnBpeF9mbXQ7CiAKICAgLyogRmlyc3Qgd2UgdHJ5IGNvZGVjLXNwZWNp
ZmljIGNvbG9ybW9kZWwgbWF0Y2hpbmcuICovCi0gIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBD
T0RFQ19JRF9ETlhIRCkKKyAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX0RO
WEhEKQogICAgIHsKICAgICAvKiBGRk1wZWcgc3VwcG9ydHMgQVZfUElYX0ZNVF9ZVVY0MjJQIGFu
ZCBBVl9QSVhfRk1UX1lVVjQyMlAxMCBmb3IgRE54SEQsIHdoaWNoCiAgICAgICAgd2Ugc29tZXRp
bWVzIGludGVycHJldCBhcyBBVl9QSVhfRk1UX1lVVko0MjJQIGFuZCBBVl9QSVhfRk1UX1lVVko0
MjJQMTAuICovCkBAIC00MzgsNyArNDM4LDcgQEAKICAgcXVpY2t0aW1lX2ZmbXBlZ192aWRlb19j
b2RlY190ICpjb2RlYyA9IHZ0cmFjay0+Y29kZWMtPnByaXY7CiAgIGNvZGVjLT5hdmN0eC0+cGl4
X2ZtdCA9IGxxdF9mZm1wZWdfZ2V0X2ZmbXBlZ19jb2xvcm1vZGVsKHZ0cmFjay0+c3RyZWFtX2Nt
b2RlbCk7CiAKLSAgaWYgKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9ETlhIRCkKKyAg
aWYgKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9ETlhIRCkKICAgICB7CiAgICAg
LyogRkZNcGVnJ3MgRE54SEQgZW5jb2RlciBvbmx5IHN1cHBvcnRzIEFWX1BJWF9GTVRfWVVWNDIy
UCBhbmQgQVZfUElYX0ZNVF9ZVVY0MjJQMTAKICAgICAgICBhbmQgZG9lc24ndCBrbm93IGFueXRo
aW5nIGFib3V0IEFWX1BJWF9GTVRfWVVWSjQyMlAgYW5kIEFWX1BJWF9GTVRfWVVWSjQyMlAxMApA
QCAtNzI4LDEzICs3MjgsMTMgQEAKIAogICAgIC8qIFNldCBleHRyYWRhdGE6IEl0J3MgZG9uZSBk
aWZmZXJlbnRseSBmb3IgZWFjaCBjb2RlYyAqLwogCi0gICAgaWYoY29kZWMtPmRlY29kZXItPmlk
ID09IENPREVDX0lEX1NWUTMpCisgICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVD
X0lEX1NWUTMpCiAgICAgICB7CiAgICAgICBleHRyYWRhdGEgICAgICAgPSB0cmFrLT5tZGlhLm1p
bmYuc3RibC5zdHNkLnRhYmxlWzBdLnRhYmxlX3JhdyArIDQ7CiAgICAgICBleHRyYWRhdGFfc2l6
ZSAgPSB0cmFrLT5tZGlhLm1pbmYuc3RibC5zdHNkLnRhYmxlWzBdLnRhYmxlX3Jhd19zaXplIC0g
NDsKICAgICAgIAogICAgICAgfQotICAgIGVsc2UgaWYoY29kZWMtPmRlY29kZXItPmlkID09IENP
REVDX0lEX0gyNjQpCisgICAgZWxzZSBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNf
SURfSDI2NCkKICAgICAgIHsKICAgICAgIHVzZXJfYXRvbSA9IHF1aWNrdGltZV9zdHNkX2dldF91
c2VyX2F0b20odHJhaywgImF2Y0MiLCAmdXNlcl9hdG9tX2xlbik7CiAKQEAgLTc1Myw3ICs3NTMs
NyBAQAogICAgICAgICB9CiAgICAgICAKICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5kZWNv
ZGVyLT5pZCA9PSBDT0RFQ19JRF9NUEVHNCkKKyAgICBlbHNlIGlmKGNvZGVjLT5kZWNvZGVyLT5p
ZCA9PSBBVl9DT0RFQ19JRF9NUEVHNCkKICAgICAgIHsKICAgICAgIGlmKHRyYWstPm1kaWEubWlu
Zi5zdGJsLnN0c2QudGFibGVbMF0uaGFzX2VzZHMpCiAgICAgICAgIHsKQEAgLTk0NywxNSArOTQ3
LDE1IEBACiAgICAgICAgICAgfQogI2VuZGlmCiAgICAgICB9Ci0gICAgaWYoY29kZWMtPmRlY29k
ZXItPmlkID09IENPREVDX0lEX0RWVklERU8pCisgICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09
IEFWX0NPREVDX0lEX0RWVklERU8pCiAgICAgICB7CiAgICAgICBpZih2dHJhY2stPnN0cmVhbV9j
bW9kZWwgPT0gQkNfWVVWNDIwUCkKICAgICAgICAgdnRyYWNrLT5jaHJvbWFfcGxhY2VtZW50ID0g
TFFUX0NIUk9NQV9QTEFDRU1FTlRfRFZQQUw7CiAgICAgICB2dHJhY2stPmludGVybGFjZV9tb2Rl
ID0gTFFUX0lOVEVSTEFDRV9CT1RUT01fRklSU1Q7CiAgICAgICB2dHJhY2stPmNpLmlkID0gTFFU
X0NPTVBSRVNTSU9OX0RWOwogICAgICAgfQotICAgIGVsc2UgaWYoKGNvZGVjLT5kZWNvZGVyLT5p
ZCA9PSBDT0RFQ19JRF9NUEVHNCkgfHwKLSAgICAgICAgICAgIChjb2RlYy0+ZGVjb2Rlci0+aWQg
PT0gQ09ERUNfSURfSDI2NCkpCisgICAgZWxzZSBpZigoY29kZWMtPmRlY29kZXItPmlkID09IEFW
X0NPREVDX0lEX01QRUc0KSB8fAorICAgICAgICAgICAgKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBB
Vl9DT0RFQ19JRF9IMjY0KSkKICAgICAgIHsKICAgICAgIGlmKHZ0cmFjay0+c3RyZWFtX2Ntb2Rl
bCA9PSBCQ19ZVVY0MjBQKQogICAgICAgICB2dHJhY2stPmNocm9tYV9wbGFjZW1lbnQgPSBMUVRf
Q0hST01BX1BMQUNFTUVOVF9NUEVHMjsKQEAgLTEyOTksMTMgKzEyOTksMTMgQEAKICAgICB7CiAg
ICAgaWYodnRyYWNrLT5zdHJlYW1fY21vZGVsID09IEJDX1lVVjQyMFApCiAgICAgICB7Ci0gICAg
ICBpZihjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfTVBFRzQpCisgICAgICBpZihjb2Rl
Yy0+ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVBFRzQpCiAgICAgICAgIHsKICAgICAgICAg
dnRyYWNrLT5jaHJvbWFfcGxhY2VtZW50ID0gTFFUX0NIUk9NQV9QTEFDRU1FTlRfTVBFRzI7CiAg
ICAgICAgIC8qIGVuYWJsZSBpbnRlcmxhY2VkIGVuY29kaW5nICovCiAgICAgICAgIHZ0cmFjay0+
aW50ZXJsYWNlX21vZGUgPSBMUVRfSU5URVJMQUNFX05PTkU7CiAgICAgICAgIH0KLSAgICAgIGVs
c2UgaWYoY29kZWMtPmVuY29kZXItPmlkID09IENPREVDX0lEX0RWVklERU8pCisgICAgICBlbHNl
IGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9EVlZJREVPKQogICAgICAgICB7
CiAgICAgICAgIHZ0cmFjay0+Y2hyb21hX3BsYWNlbWVudCA9IExRVF9DSFJPTUFfUExBQ0VNRU5U
X0RWUEFMOwogICAgICAgICB9CkBAIC0xMzQwLDcgKzEzNDAsNyBAQAogICAgIGNvZGVjLT5hdmN0
eC0+c2FtcGxlX2FzcGVjdF9yYXRpby5udW0gPSBwaXhlbF93aWR0aDsKICAgICBjb2RlYy0+YXZj
dHgtPnNhbXBsZV9hc3BlY3RfcmF0aW8uZGVuID0gcGl4ZWxfaGVpZ2h0OwogICAgIC8qIFVzZSBn
bG9iYWwgaGVhZGVycyBmb3IgbXA0diAqLwotICAgIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBD
T0RFQ19JRF9NUEVHNCkKKyAgICBpZihjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURf
TVBFRzQpCiAgICAgICB7CiAgICAgICBpZighKGZpbGUtPmZpbGVfdHlwZSAmIChMUVRfRklMRV9B
Vkl8TFFUX0ZJTEVfQVZJX09ETUwpKSkKICAgICAgICAgewpAQCAtMTM2NCwxMiArMTM2NCwxMiBA
QAogICAgICAgICB9CiAjZW5kaWYKICAgICAgIH0KLSAgICBlbHNlIGlmKChjb2RlYy0+ZW5jb2Rl
ci0+aWQgPT0gQ09ERUNfSURfTVNNUEVHNFYzKSAmJiAodHJhay0+c3RybCkgJiYKKyAgICBlbHNl
IGlmKChjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVNNUEVHNFYzKSAmJiAodHJh
ay0+c3RybCkgJiYKICAgICAgICAgICAgICFzdHJuY21wKHRyYWstPnN0cmwtPnN0cmYuYmguYmlD
b21wcmVzc2lvbiwgIkRJVjMiLCA0KSkKICAgICAgIHsKICAgICAgIHN0cm5jcHkodHJhay0+c3Ry
bC0+c3RyaC5mY2NIYW5kbGVyLCAiZGl2MyIsIDQpOwogICAgICAgfQotICAgIGVsc2UgaWYoKGNv
ZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9IMjYzKSAmJgorICAgIGVsc2UgaWYoKGNvZGVj
LT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9IMjYzKSAmJgogICAgICAgICAgICAgKGZpbGUt
PmZpbGVfdHlwZSAmIChMUVRfRklMRV9NUDR8TFFUX0ZJTEVfM0dQKSkpCiAgICAgICB7CiAgICAg
ICB1aW50OF90IGQyNjNfZGF0YVtdID0KQEAgLTEzODMsNyArMTM4Myw3IEBACiAgICAgICBzdHJu
Y3B5KHRyYWstPm1kaWEubWluZi5zdGJsLnN0c2QudGFibGVbMF0uZm9ybWF0LAogICAgICAgICAg
ICAgICAiczI2MyIsIDQpOwogICAgICAgfQotICAgIGVsc2UgaWYoY29kZWMtPmVuY29kZXItPmlk
ID09IENPREVDX0lEX0ZGVkhVRkYpCisgICAgZWxzZSBpZihjb2RlYy0+ZW5jb2Rlci0+aWQgPT0g
QVZfQ09ERUNfSURfRkZWSFVGRikKICAgICAgIHsKICAgICAgIGlmKCEoZmlsZS0+ZmlsZV90eXBl
ICYgKExRVF9GSUxFX0FWSXxMUVRfRklMRV9BVklfT0RNTCkpKQogICAgICAgICB7CkBAIC0xMzkx
LDcgKzEzOTEsNyBAQAogICAgICAgICBjb2RlYy0+d3JpdGVfZ2xvYmFsX2hlYWRlciA9IDE7CiAg
ICAgICAgIH0KICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RF
Q19JRF9RVFJMRSkKKyAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19J
RF9RVFJMRSkKICAgICAgIHsKICAgICAgIGlmKHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9PSBCQ19S
R0JBODg4OCkKICAgICAgICAgewpAQCAtMTQwMiwxMSArMTQwMiwxMSBAQAogICAgICAgICB2dHJh
Y2stPnRyYWNrLT5tZGlhLm1pbmYuc3RibC5zdHNkLnRhYmxlWzBdLmRlcHRoID0gMzI7CiAgICAg
ICAgIH0KICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19J
RF9EVlZJREVPKQorICAgIGVsc2UgaWYoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lE
X0RWVklERU8pCiAgICAgICB7CiAgICAgICBzZXRfZHZfZm91cmNjKHdpZHRoLCBoZWlnaHQsIHZ0
cmFjay0+c3RyZWFtX2Ntb2RlbCwgdHJhayk7CiAgICAgICB9Ci0gICAgZWxzZSBpZihjb2RlYy0+
ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRE5YSEQpCisgICAgZWxzZSBpZihjb2RlYy0+ZW5jb2Rl
ci0+aWQgPT0gQVZfQ09ERUNfSURfRE5YSEQpCiAgICAgICB7CiAgICAgICBpZih2dHJhY2stPmlu
dGVybGFjZV9tb2RlICE9IExRVF9JTlRFUkxBQ0VfTk9ORSkKICAgICAgICAgewpAQCAtMTU1OCwx
MiArMTU1OCwxMiBAQAogICAKICNlbmRpZgogICAKLSAgaWYoIXdhc19pbml0aWFsaXplZCAmJiBj
b2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRE5YSEQpCisgIGlmKCF3YXNfaW5pdGlhbGl6
ZWQgJiYgY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX0ROWEhEKQogICAgIHNldHVw
X2F2aWRfYXRvbXMoZmlsZSwgdnRyYWNrLCBjb2RlYy0+YnVmZmVyLCBieXRlc19lbmNvZGVkKTsK
ICAgCiAgIGlmKGJ5dGVzX2VuY29kZWQpCiAgICAgewotICAgIGlmIChwdHMgPT0gQVZfTk9QVFNf
VkFMVUUgfHwgKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9ETlhIRCAmJiBwdHMgPT0g
MCkpCisgICAgaWYgKHB0cyA9PSBBVl9OT1BUU19WQUxVRSB8fCAoY29kZWMtPmVuY29kZXItPmlk
ID09IEFWX0NPREVDX0lEX0ROWEhEICYmIHB0cyA9PSAwKSkKICAgICAgIHsKICAgICAgIC8qIFNv
bWUgY29kZWNzIGRvbid0IGJvdGhlciBnZW5lcmF0aW5nIHByZXNlbnRhdGlvbiB0aW1lc3RhbXBz
LgogICAgICAgICAgRkZNcGVnJ3MgRE54SEQgZW5jb2RlciBkb2Vzbid0IGV2ZW4gYm90aGVyIHRv
IHNldCBpdCB0byBBVl9OT1BUU19WQUxVRS4gKi8KQEAgLTE1OTAsMTMgKzE1OTAsMTMgQEAKIAog
ICBpZihjb2RlYy0+d3JpdGVfZ2xvYmFsX2hlYWRlciAmJiAhY29kZWMtPmdsb2JhbF9oZWFkZXJf
d3JpdHRlbikKICAgICB7Ci0gICAgaWYoY29kZWMtPmVuY29kZXItPmlkID09IENPREVDX0lEX0ZG
VkhVRkYpCisgICAgaWYoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX0ZGVkhVRkYp
CiAgICAgICB7CiAgICAgICBxdWlja3RpbWVfdXNlcl9hdG9tc19hZGRfYXRvbSgmdHJhay0+bWRp
YS5taW5mLnN0Ymwuc3RzZC50YWJsZVswXS51c2VyX2F0b21zLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgImdsYmwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29kZWMtPmF2Y3R4LT5leHRyYWRhdGEsIGNvZGVjLT5hdmN0eC0+ZXh0cmFkYXRhX3Np
emUgKTsKICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19J
RF9NUEVHNCkKKyAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9N
UEVHNCkKICAgICAgIHsKICAgICAgIGludCBhZHZhbmNlZCA9IDA7CiAgICAgICBpZihjb2RlYy0+
YXZjdHgtPm1heF9iX2ZyYW1lcyB8fApAQCAtMTkwMywxOCArMTkwMywxOCBAQAogICAgIGNvZGVj
X2Jhc2UtPmVuY29kZV92aWRlbyA9IGxxdF9mZm1wZWdfZW5jb2RlX3ZpZGVvOwogICAgIGNvZGVj
X2Jhc2UtPnNldF9wYXNzID0gc2V0X3Bhc3NfZmZtcGVnOwogCi0gICAgaWYoZW5jb2Rlci0+aWQg
PT0gQ09ERUNfSURfTVBFRzQpCisgICAgaWYoZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVBF
RzQpCiAgICAgICB7CiAgICAgICBjb2RlY19iYXNlLT53cml0ZXNfY29tcHJlc3NlZCA9IHdyaXRl
c19jb21wcmVzc2VkX21wZWc0OwogICAgICAgY29kZWNfYmFzZS0+aW5pdF9jb21wcmVzc2VkICAg
PSBpbml0X2NvbXByZXNzZWRfbXBlZzQ7CiAgICAgICBjb2RlY19iYXNlLT53cml0ZV9wYWNrZXQg
PSB3cml0ZV9wYWNrZXRfbXBlZzQ7CiAgICAgICB9Ci0gICAgZWxzZSBpZihlbmNvZGVyLT5pZCA9
PSBDT0RFQ19JRF9NUEVHMlZJREVPKQorICAgIGVsc2UgaWYoZW5jb2Rlci0+aWQgPT0gQVZfQ09E
RUNfSURfTVBFRzJWSURFTykKICAgICAgIHsKICAgICAgIGNvZGVjX2Jhc2UtPndyaXRlc19jb21w
cmVzc2VkID0gd3JpdGVzX2NvbXByZXNzZWRfaW14OwogICAgICAgY29kZWNfYmFzZS0+aW5pdF9j
b21wcmVzc2VkICAgPSBpbml0X2NvbXByZXNzZWRfaW14OwogICAgICAgfQotICAgIGVsc2UgaWYo
ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRFZWSURFTykKKyAgICBlbHNlIGlmKGVuY29kZXItPmlk
ID09IEFWX0NPREVDX0lEX0RWVklERU8pCiAgICAgICB7CiAgICAgICBjb2RlY19iYXNlLT5pbml0
X2NvbXByZXNzZWQgPSBpbml0X2NvbXByZXNzZWRfZHY7CiAgICAgICB9CkBAIC0xOTIyLDcgKzE5
MjIsNyBAQAogICAgIH0KICAgaWYoZGVjb2RlcikKICAgICB7Ci0gICAgaWYoZGVjb2Rlci0+aWQg
PT0gQ09ERUNfSURfSDI2NCkKKyAgICBpZihkZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9IMjY0
KQogICAgICAgY29kZWNfYmFzZS0+cmVhZF9wYWNrZXQgPSByZWFkX3BhY2tldF9oMjY0OwogICAg
IGNvZGVjX2Jhc2UtPmRlY29kZV92aWRlbyA9IGxxdF9mZm1wZWdfZGVjb2RlX3ZpZGVvOwogICAg
IH0KLS0tIGxpYnF1aWNrdGltZS0xLjIuNC9wbHVnaW5zL2ZmbXBlZy9hdWRpby5jLm9yaWcJMjAx
Ni0wMi0xNyAwODoxNzo1Ny40MjE0ODE5MzQgKzAwMDAKKysrIGxpYnF1aWNrdGltZS0xLjIuNC9w
bHVnaW5zL2ZmbXBlZy9hdWRpby5jCTIwMTYtMDItMTcgMDg6MTg6MDUuMjU0NzgyMzA1ICswMDAw
CkBAIC02MjYsNyArNjI2LDcgQEAKICAgICB7CiAgICAgLyogSWYgdGhlIGNvZGVjIGlzIG1wMywg
bWFrZSBzdXJlIHRvIGRlY29kZSB0aGUgdmVyeSBsYXN0IGZyYW1lICovCiAKLSAgICBpZigoY29k
ZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBDT0RFQ19JRF9NUDMpICYmCisgICAgaWYoKGNvZGVjLT5h
dmN0eC0+Y29kZWNfaWQgPT0gQVZfQ09ERUNfSURfTVAzKSAmJgogICAgICAgIChjb2RlYy0+Ynl0
ZXNfaW5fY2h1bmtfYnVmZmVyID49IDQpKQogICAgICAgewogICAgICAgaWYoIW1wYV9kZWNvZGVf
aGVhZGVyKCZtcGgsIGNvZGVjLT5jaHVua19idWZmZXIsIChjb25zdCBtcGFfaGVhZGVyKikwKSkK
QEAgLTY5NSw3ICs2OTUsNyBAQAogICAgIAogICAgIC8qIFNvbWUgcmVhbGx5IGJyb2tlbiBtcDMg
ZmlsZXMgaGF2ZSB0aGUgaGVhZGVyIGJ5dGVzIHNwbGl0IGFjcm9zcyAyIGNodW5rcyAqLwogCi0g
ICAgaWYoY29kZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBDT0RFQ19JRF9NUDMpCisgICAgaWYoY29k
ZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBBVl9DT0RFQ19JRF9NUDMpCiAgICAgICB7CiAgICAgICBp
Zihjb2RlYy0+Ynl0ZXNfaW5fY2h1bmtfYnVmZmVyIDwgNCkKICAgICAgICAgewpAQCAtODA2LDcg
KzgwNiw3IEBACiAgICAgCiAgICAgaWYoYnl0ZXNfZGVjb2RlZCA8IDApCiAgICAgICB7Ci0gICAg
ICBpZihjb2RlYy0+YXZjdHgtPmNvZGVjX2lkID09IENPREVDX0lEX01QMykKKyAgICAgIGlmKGNv
ZGVjLT5hdmN0eC0+Y29kZWNfaWQgPT0gQVZfQ09ERUNfSURfTVAzKQogICAgICAgICB7CiAgICAg
ICAgIC8qIEZvciBtcDMsIGJ5dGVzX2RlY29kZWQgPCAwIG1lYW5zLCB0aGF0IHRoZSBmcmFtZSBz
aG91bGQgYmUgbXV0ZWQgKi8KICAgICAgICAgbWVtc2V0KCZjb2RlYy0+c2FtcGxlX2J1ZmZlclt0
cmFja19tYXAtPmNoYW5uZWxzICogKGNvZGVjLT5zYW1wbGVfYnVmZmVyX2VuZCAtCkBAIC04NjYs
OCArODY2LDggQEAKICAgcXVpY2t0aW1lX2F1ZGlvX21hcF90ICp0cmFja19tYXAgPSAmZmlsZS0+
YXRyYWNrc1t0cmFja107CiAgIHF1aWNrdGltZV9mZm1wZWdfYXVkaW9fY29kZWNfdCAqY29kZWMg
PSB0cmFja19tYXAtPmNvZGVjLT5wcml2OwogCi0gIGlmKChjb2RlYy0+ZGVjb2Rlci0+aWQgPT0g
Q09ERUNfSURfTVAyKSB8fAotICAgICAoY29kZWMtPmRlY29kZXItPmlkID09IENPREVDX0lEX01Q
MykpCisgIGlmKChjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVAyKSB8fAorICAg
ICAoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX01QMykpCiAgICAgewogICAgIG1w
YV9oZWFkZXIgaDsKICAgICB1aW50MzJfdCBoZWFkZXI7CkBAIC05MDksNyArOTA5LDcgQEAKICAg
ICBlbHNlCiAgICAgICB0cmFja19tYXAtPmNpLmJpdHJhdGUgPSBoLmJpdHJhdGU7CiAgICAgfQot
ICBlbHNlIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9BQzMpCisgIGVsc2UgaWYo
Y29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX0FDMykKICAgICB7CiAgICAgYTUyX2hl
YWRlciBoOwogICAgIHVpbnQ4X3QgKiBwdHI7CkBAIC05ODYsNyArOTg2LDcgQEAKICNlbmRpZgog
ICAgIC8qIFNvbWUgY29kZWNzIG5lZWQgZXh0cmEgc3R1ZmYgKi8KIAotICAgIGlmKGNvZGVjLT5k
ZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9BTEFDKQorICAgIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9
PSBBVl9DT0RFQ19JRF9BTEFDKQogICAgICAgewogICAgICAgaGVhZGVyID0gcXVpY2t0aW1lX3dh
dmVfZ2V0X3VzZXJfYXRvbSh0cmFja19tYXAtPnRyYWNrLCAiYWxhYyIsICZoZWFkZXJfbGVuKTsK
ICAgICAgIGlmKGhlYWRlcikKQEAgLTk5NSw3ICs5OTUsNyBAQAogICAgICAgICBjb2RlYy0+YXZj
dHgtPmV4dHJhZGF0YV9zaXplID0gaGVhZGVyX2xlbjsKICAgICAgICAgfQogICAgICAgfQotICAg
IGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9RRE0yKQorICAgIGlmKGNvZGVjLT5k
ZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9RRE0yKQogICAgICAgewogICAgICAgaGVhZGVyID0g
cXVpY2t0aW1lX3dhdmVfZ2V0X3VzZXJfYXRvbSh0cmFja19tYXAtPnRyYWNrLCAiUURDQSIsICZo
ZWFkZXJfbGVuKTsKICAgICAgIGlmKGhlYWRlcikKQEAgLTE0OTUsOSArMTQ5NSw5IEBACiAgICAg
Y29kZWNfYmFzZS0+ZGVjb2RlX2F1ZGlvID0gbHF0X2ZmbXBlZ19kZWNvZGVfYXVkaW87CiAgIGNv
ZGVjX2Jhc2UtPnNldF9wYXJhbWV0ZXIgPSBzZXRfcGFyYW1ldGVyOwogCi0gIGlmKChkZWNvZGVy
LT5pZCA9PSBDT0RFQ19JRF9NUDMpIHx8IChkZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9NUDIpKQor
ICBpZigoZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVAzKSB8fCAoZGVjb2Rlci0+aWQgPT0g
QVZfQ09ERUNfSURfTVAyKSkKICAgICBjb2RlY19iYXNlLT5yZWFkX3BhY2tldCA9IHJlYWRfcGFj
a2V0X21wYTsKLSAgZWxzZSBpZihkZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9BQzMpCisgIGVsc2Ug
aWYoZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfQUMzKQogICAgIHsKICAgICBjb2RlY19iYXNl
LT53cml0ZV9wYWNrZXQgPSB3cml0ZV9wYWNrZXRfYWMzOwogICAgIGNvZGVjX2Jhc2UtPnJlYWRf
cGFja2V0ID0gcmVhZF9wYWNrZXRfYWMzOwo=
" | base64 -d > $TMP/libquicktime-ffmpeg3.patch

patch -p1 -i $TMP/libquicktime-ffmpeg3.patch || exit 1

CFLAGS="$SLKCFLAGS" \
CXXFLAGS="$SLKCFLAGS" \
./configure \
  --prefix=/usr \
  --libdir=/usr/lib${LIBDIRSUFFIX} \
  --sysconfdir=/etc \
  --localstatedir=/var \
  --mandir=/usr/man \
  --docdir=/usr/doc/$PRGNAM-$VERSION \
  --enable-gpl \
  --with-libdv \
  --build=$ARCH-slackware-linux

echo 
echo "$VERDE"Compilando ..."$CIERRE"
sleep 1

make || exit 1
make install-strip DESTDIR=$PKG
}

###################################
## BLOQUE PRINCIPAL DE EJECUCION ##
###################################
# Si se cierra el script inesperadamente, ejecutar la funcion de limpieza
trap f_exitmode SIGHUP SIGINT

#Inicializamos las variables globales
f_variables
#Asignamos o detectamos arquitectura
f_arquitectura
#Comprobamos conexion a Internet
f_comprobarConexion
#Inicializamos las variables del script
F_variables
#Creamos directorio de trabajo
f_directorioTemporal
#Mostramos el mensaje de presentacion
f_presentacion
#Comprobamos updates del script
f_comprobarUpdates
#Comprobamos version instalada del paquete
f_versionInstalada
#Compronar dependencias
F_dependencias
#Si no existe el fichero se descargara
f_download
#Preparamos entorno
f_preparar
#Descomprimir fichero descargado y compilamos
F_compilar
#Hacemos strip sobre el paquete
f_strip
#Creamos xzm , instalamos y salimos
f_tareasFinales